(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7728:function(e,a,t){Promise.resolve().then(t.bind(t,9531))},9531:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return $}});var s=t(7437),r=t(2265),n=t(3464);class i{handleError(e){var a,t,s,r;throw Error((null===(t=e.response)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.detail)||(null===(r=e.response)||void 0===r?void 0:null===(s=r.data)||void 0===s?void 0:s.error)||e.message||"Error desconocido")}async getSystemStatus(){try{return(await this.api.get("/api/status")).data}catch(e){this.handleError(e)}}async getSettings(){try{return(await this.api.get("/api/settings")).data}catch(e){this.handleError(e)}}async saveSettings(e){try{return(await this.api.post("/api/settings",e)).data}catch(e){this.handleError(e)}}async getPrompts(){try{return(await this.api.get("/api/prompts")).data}catch(e){this.handleError(e)}}async savePrompts(e){try{return(await this.api.post("/api/prompts",e)).data}catch(e){this.handleError(e)}}async getFile(e){try{return(await this.api.get("/api/files/".concat(e))).data}catch(e){this.handleError(e)}}async getDocsContent(){try{return(await this.api.get("/api/docs-content")).data}catch(e){return console.warn("Could not load docs content:",e),null}}async saveFile(e,a){try{return(await this.api.post("/api/files/".concat(e),{content:a})).data}catch(e){this.handleError(e)}}async getAllowedContacts(){try{return(await this.api.get("/api/allowed-contacts")).data}catch(e){this.handleError(e)}}async addAllowedContact(e){try{return(await this.api.post("/api/allowed-contacts",e)).data}catch(e){this.handleError(e)}}async removeAllowedContact(e){try{return(await this.api.delete("/api/allowed-contacts/".concat(e))).data}catch(e){this.handleError(e)}}async updateAllowedContact(e,a){try{return(await this.api.put("/api/allowed-contacts/".concat(e),a)).data}catch(e){this.handleError(e)}}async getChatData(e){try{return(await this.api.get("/api/chats/".concat(e))).data}catch(e){this.handleError(e)}}async saveChatData(e,a){try{return(await this.api.post("/api/chats/".concat(e),a)).data}catch(e){this.handleError(e)}}async refreshChatContext(e){try{return(await this.api.post("/api/chats/".concat(e,"/refresh-context"))).data}catch(e){this.handleError(e)}}async getLMStudioModels(){try{return(await this.api.get("/api/lmstudio/models")).data}catch(e){this.handleError(e)}}async getLocalOnlyModels(){try{return(await this.api.get("/api/lmstudio/models/local-only")).data}catch(e){this.handleError(e)}}async startLMStudio(){try{return(await this.api.post("/api/lmstudio/start")).data}catch(e){this.handleError(e)}}async startLMStudioServer(){try{return(await this.api.post("/api/lmstudio/server/start")).data}catch(e){this.handleError(e)}}async stopLMStudioServer(){try{return(await this.api.post("/api/lmstudio/server/stop")).data}catch(e){this.handleError(e)}}async loadLMStudioModel(e){try{return(await this.api.post("/api/lmstudio/load",{model:e})).data}catch(e){this.handleError(e)}}async getCurrentModel(){try{return(await this.api.get("/api/current-model")).data}catch(e){this.handleError(e)}}async setCurrentModel(e){try{return(await this.api.post("/api/current-model",{model:e})).data}catch(e){this.handleError(e)}}async getReasonerModel(){try{return(await this.api.get("/api/reasoner-model")).data}catch(e){this.handleError(e)}}async setReasonerModel(e){try{return(await this.api.post("/api/reasoner-model",{model:e})).data}catch(e){this.handleError(e)}}async getWhatsAppStatus(){try{return(await this.api.get("/api/whatsapp/status")).data}catch(e){this.handleError(e)}}async startWhatsApp(){try{return(await this.api.post("/api/whatsapp/start")).data}catch(e){this.handleError(e)}}async stopWhatsApp(){try{return(await this.api.post("/api/whatsapp/stop")).data}catch(e){this.handleError(e)}}async sendWhatsAppMessage(e,a){try{return(await this.api.post("/api/whatsapp/send",{chat_id:e,message:a})).data}catch(e){this.handleError(e)}}async stopAllServices(){try{return(await this.api.post("/api/system/stop-all")).data}catch(e){this.handleError(e)}}async getAnalytics(){try{return(await this.api.get("/api/analytics")).data}catch(e){this.handleError(e)}}async getEvents(){try{return(await this.api.get("/api/events")).data}catch(e){this.handleError(e)}}async uploadMedia(e){try{let a=new FormData;return a.append("file",e),(await this.api.post("/api/media/upload",a,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(e){this.handleError(e)}}async listMedia(){try{return(await this.api.get("/api/media/list")).data}catch(e){this.handleError(e)}}async deleteMedia(e,a){try{return(await this.api.delete("/api/media/".concat(e,"/").concat(a))).data}catch(e){this.handleError(e)}}async sendMediaMessage(e,a,t,s){try{let r=new FormData;return r.append("chat_id",e),r.append("message",a),r.append("media_type",t),r.append("filename",s),(await this.api.post("/api/whatsapp/send-media",r,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(e){this.handleError(e)}}async clearConversation(e){try{return(await this.api.post("/api/conversations/clear",{chat_id:e})).data}catch(e){this.handleError(e)}}async getContacts(){try{return(await this.api.get("/api/contacts")).data}catch(e){this.handleError(e)}}async composeMessage(e,a,t){try{return(await this.api.post("/api/chat/compose",{contact_id:e,objective:a,context:t})).data}catch(e){this.handleError(e)}}async getOnlineModels(){try{return(await this.api.get("/api/models/online")).data}catch(e){this.handleError(e)}}async saveOnlineModel(e){try{return(await this.api.post("/api/models/online",e)).data}catch(e){this.handleError(e)}}async deleteOnlineModel(e){try{return(await this.api.delete("/api/models/online/".concat(e))).data}catch(e){this.handleError(e)}}async getAvailableOnlineModels(){try{return(await this.api.get("/api/models/online/available")).data}catch(e){this.handleError(e)}}async getOnlineApisConfig(){try{return(await this.api.get("/api/online-apis/config")).data}catch(e){this.handleError(e)}}async saveOnlineApisConfig(e){try{return(await this.api.post("/api/online-apis/config",e)).data}catch(e){this.handleError(e)}}async testOnlineApi(e){try{return(await this.api.post("/api/online-apis/test/".concat(e))).data}catch(e){this.handleError(e)}}async getOnlineApiModels(e){try{return(await this.api.get("/api/online-apis/models/".concat(e))).data}catch(e){this.handleError(e)}}async checkConnection(){try{return await this.getSystemStatus(),!0}catch(e){return!1}}async listSecureApis(){try{return(await this.api.get("/api/secure-apis/list")).data}catch(e){this.handleError(e)}}async storeSecureApi(e,a,t){try{return(await this.api.post("/api/secure-apis/store",{provider:e,api_key:a,metadata:t})).data}catch(e){this.handleError(e)}}async getSecureApiKey(e){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{return(await this.api.get("/api/secure-apis/key/".concat(e,"?show_key=").concat(a))).data}catch(e){this.handleError(e)}}async testSecureApi(e){try{return(await this.api.post("/api/secure-apis/test/".concat(e))).data}catch(e){this.handleError(e)}}async removeSecureApi(e){try{return(await this.api.delete("/api/secure-apis/remove/".concat(e))).data}catch(e){this.handleError(e)}}async getProviderInfo(e){try{return(await this.api.get("/api/secure-apis/provider-info/".concat(e))).data}catch(e){this.handleError(e)}}async getOpenAIModels(){try{return(await this.api.get("/api/openai/models")).data}catch(e){this.handleError(e)}}async testOpenAIConnection(){try{return(await this.api.post("/api/openai/test-connection")).data}catch(e){this.handleError(e)}}async generateOpenAIResponse(e){try{return(await this.api.post("/api/openai/generate",e)).data}catch(e){this.handleError(e)}}async estimateOpenAICost(e,a){try{return(await this.api.post("/api/openai/estimate-cost",{text:e,model:a})).data}catch(e){this.handleError(e)}}async getOpenAIUsageStats(){try{return(await this.api.get("/api/openai/usage-stats")).data}catch(e){this.handleError(e)}}async getClaudeModels(){try{return(await this.api.get("/api/claude/models")).data}catch(e){this.handleError(e)}}async testClaudeConnection(){try{return(await this.api.post("/api/claude/test-connection")).data}catch(e){this.handleError(e)}}async generateClaudeResponse(e){try{return(await this.api.post("/api/claude/generate",e)).data}catch(e){this.handleError(e)}}async estimateClaudeCost(e,a){try{return(await this.api.post("/api/claude/estimate-cost",{text:e,model:a})).data}catch(e){this.handleError(e)}}async getClaudeUsageStats(){try{return(await this.api.get("/api/claude/usage-stats")).data}catch(e){this.handleError(e)}}async getGeminiModels(){try{return(await this.api.get("/api/gemini/models")).data}catch(e){this.handleError(e)}}async testGeminiConnection(){try{return(await this.api.post("/api/gemini/test-connection")).data}catch(e){this.handleError(e)}}async generateGeminiResponse(e){try{return(await this.api.post("/api/gemini/generate",e)).data}catch(e){this.handleError(e)}}async estimateGeminiCost(e,a){try{return(await this.api.post("/api/gemini/estimate-cost",{text:e,model:a})).data}catch(e){this.handleError(e)}}async getGeminiUsageStats(){try{return(await this.api.get("/api/gemini/usage-stats")).data}catch(e){this.handleError(e)}}async getXAIModels(){try{return(await this.api.get("/api/xai/models")).data}catch(e){this.handleError(e)}}async testXAIConnection(){try{return(await this.api.post("/api/xai/test-connection")).data}catch(e){this.handleError(e)}}async generateXAIResponse(e){try{return(await this.api.post("/api/xai/generate",e)).data}catch(e){this.handleError(e)}}async estimateXAICost(e,a){try{return(await this.api.post("/api/xai/estimate-cost",{text:e,model:a})).data}catch(e){this.handleError(e)}}async getXAIUsageStats(){try{return(await this.api.get("/api/xai/usage-stats")).data}catch(e){this.handleError(e)}}async getXAIRateLimits(){try{return(await this.api.get("/api/xai/rate-limits")).data}catch(e){this.handleError(e)}}async getOllamaModels(){try{return(await this.api.get("/api/ollama/models")).data}catch(e){this.handleError(e)}}async testOllamaConnection(){try{return(await this.api.post("/api/ollama/test-connection")).data}catch(e){this.handleError(e)}}async generateOllamaResponse(e){try{return(await this.api.post("/api/ollama/generate",e)).data}catch(e){this.handleError(e)}}async pullOllamaModel(e){try{return(await this.api.post("/api/ollama/pull-model",{model_name:e})).data}catch(e){this.handleError(e)}}async deleteOllamaModel(e){try{return(await this.api.delete("/api/ollama/delete-model",{data:{model_name:e}})).data}catch(e){this.handleError(e)}}async estimateOllamaCost(e,a){try{return(await this.api.post("/api/ollama/estimate-cost",{text:e,model:a})).data}catch(e){this.handleError(e)}}async getOllamaUsageStats(){try{return(await this.api.get("/api/ollama/usage-stats")).data}catch(e){this.handleError(e)}}async getOllamaSystemInfo(){try{return(await this.api.get("/api/ollama/system-info")).data}catch(e){this.handleError(e)}}async getServerLocationsStatus(){try{return(await this.api.get("/api/server-locations/status")).data}catch(e){this.handleError(e)}}async getProviderLocations(e){try{return(await this.api.get("/api/server-locations/".concat(e))).data}catch(e){this.handleError(e)}}async forceHealthCheck(e){try{return(await this.api.post("/api/server-locations/".concat(e,"/health-check"))).data}catch(e){this.handleError(e)}}async addCustomLocation(e,a){try{return(await this.api.post("/api/server-locations/".concat(e,"/add"),a)).data}catch(e){this.handleError(e)}}async removeLocation(e,a){try{return(await this.api.delete("/api/server-locations/".concat(e,"/").concat(a))).data}catch(e){this.handleError(e)}}async getBestLocation(e){try{return(await this.api.get("/api/server-locations/".concat(e,"/best"))).data}catch(e){this.handleError(e)}}async exportLocationsConfig(){try{return(await this.api.get("/api/server-locations/export")).data}catch(e){this.handleError(e)}}async importLocationsConfig(e){try{return(await this.api.post("/api/server-locations/import",{configuration:e})).data}catch(e){this.handleError(e)}}async getRealTimeStatus(){try{return(await this.api.get("/api/status/real-time")).data}catch(e){this.handleError(e)}}async forceStatusUpdate(){try{return(await this.api.post("/api/status/force-update")).data}catch(e){this.handleError(e)}}async getServiceStatus(e){try{return(await this.api.get("/api/status/service/".concat(e))).data}catch(e){this.handleError(e)}}async getServiceTrends(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24;try{return(await this.api.get("/api/status/trends/".concat(e,"?hours=").concat(a))).data}catch(e){this.handleError(e)}}async getAllRecommendations(){try{return(await this.api.get("/api/status/recommendations")).data}catch(e){this.handleError(e)}}async startStatusMonitoring(){try{return(await this.api.post("/api/status/monitoring/start")).data}catch(e){this.handleError(e)}}async stopStatusMonitoring(){try{return(await this.api.post("/api/status/monitoring/stop")).data}catch(e){this.handleError(e)}}async getCostDashboard(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"daily";try{return(await this.api.get("/api/cost/dashboard?period=".concat(e))).data}catch(e){this.handleError(e)}}async createBudgetLimit(e){try{return(await this.api.post("/api/cost/budget",e)).data}catch(e){this.handleError(e)}}async trackUsage(e){try{return(await this.api.post("/api/cost/track",e)).data}catch(e){this.handleError(e)}}async getCostStats(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"daily",a=arguments.length>1?arguments[1]:void 0;try{let t=new URLSearchParams({period:e});return a&&t.append("service",a),(await this.api.get("/api/cost/stats?".concat(t))).data}catch(e){this.handleError(e)}}async getBudgets(){try{return(await this.api.get("/api/cost/budgets")).data}catch(e){this.handleError(e)}}async getCostAlerts(e){try{return(await this.api.get("/api/cost/alerts".concat(void 0!==e?"?acknowledged=".concat(e):""))).data}catch(e){this.handleError(e)}}async acknowledgeAlert(e){try{return(await this.api.post("/api/cost/alerts/".concat(e,"/acknowledge"))).data}catch(e){this.handleError(e)}}async deleteBudget(e){try{return(await this.api.delete("/api/cost/budgets/".concat(e))).data}catch(e){this.handleError(e)}}async startCostMonitoring(){try{return(await this.api.post("/api/cost/monitoring/start")).data}catch(e){this.handleError(e)}}async stopCostMonitoring(){try{return(await this.api.post("/api/cost/monitoring/stop")).data}catch(e){this.handleError(e)}}async getAdvancedSettings(){try{return(await this.api.get("/api/advanced-settings")).data}catch(e){return{ai_third_layer:{enabled:!0,trigger_mode:"conversations",min_conversations:10,min_messages_per_conversation:10,time_interval_hours:720},media:{whisper_enabled:!0,whisper_model:"whisper-1",vision_enabled:!0,vision_model:"gpt-4-vision-preview"},whatsapp:{mode:"playwright"}}}}async saveAdvancedSettings(e){try{return(await this.api.put("/api/advanced-settings",e)).data}catch(e){this.handleError(e)}}async testWhisper(){try{return(await this.api.post("/api/advanced-settings/test-whisper")).data}catch(e){this.handleError(e)}}async testVision(){try{return(await this.api.post("/api/advanced-settings/test-vision")).data}catch(e){this.handleError(e)}}async triggerGlobalLearner(){try{return(await this.api.post("/api/advanced-settings/trigger-global-learner")).data}catch(e){this.handleError(e)}}constructor(){this.api=n.Z.create({baseURL:"http://127.0.0.1:8014",timeout:1e4,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(e=>(e.headers.Authorization="Bearer admintoken",e),e=>Promise.reject(e)),this.api.interceptors.response.use(e=>e,e=>(console.error("API Error:",e),Promise.reject(e)))}}let l=new i;var o=t(9778),c=t(9734),d=t(2930),m=t(6331),h=t(2775),x=t(322),u=t(1442),g=t(2907),p=t(301);let b=[{id:"main",name:"Principal",icon:o.Z,description:"Control principal del sistema"},{id:"config",name:"Configuraci\xf3n",icon:c.Z,description:"Configurar modelos y API keys"},{id:"contacts",name:"Contactos",icon:d.Z,description:"Gesti\xf3n de contactos y mensajes"},{id:"stats",name:"Estad\xedsticas",icon:m.Z,description:"M\xe9tricas y an\xe1lisis"},{id:"advanced",name:"Avanzado",icon:h.Z,description:"IA, Multimedia, WhatsApp"}];function y(e){let{currentPage:a,onPageChange:t,systemStatus:r}=e,n=(()=>{var e,a;if(!r)return{icon:x.Z,color:"text-yellow-500",bg:"bg-yellow-100",text:"Conectando..."};let t=null==r?void 0:null===(e=r.whatsapp)||void 0===e?void 0:e.is_running,s=null==r?void 0:null===(a=r.lm_studio)||void 0===a?void 0:a.is_running;return t&&s?{icon:u.Z,color:"text-green-500",bg:"bg-green-100",text:"Todo funcionando"}:t||s?{icon:g.Z,color:"text-yellow-500",bg:"bg-yellow-100",text:"Parcialmente activo"}:{icon:p.Z,color:"text-red-500",bg:"bg-red-100",text:"Servicios detenidos"}})();return(0,s.jsxs)("div",{className:"w-64 bg-white shadow-xl border-r border-gray-200 flex flex-col",children:[(0,s.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,s.jsx)("h1",{className:"text-xl font-bold text-gray-900 mb-2",children:"\uD83E\uDD16 Chatbot Admin"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 p-3 rounded-lg ".concat(n.bg," transition-all duration-300"),children:[(0,s.jsx)(n.icon,{className:"h-5 w-5 ".concat(n.color)}),(0,s.jsx)("span",{className:"text-sm font-medium ".concat(n.color),children:n.text})]})]}),(0,s.jsx)("nav",{className:"flex-1 p-4 space-y-2",children:b.map(e=>{let r=a===e.id;return(0,s.jsxs)("button",{onClick:()=>t(e.id),className:"\n                w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-left transition-all duration-200\n                ".concat(r?"bg-gradient-to-r from-blue-500 to-indigo-600 text-white shadow-lg transform scale-105":"text-gray-700 hover:bg-gray-100 hover:shadow-md","\n              "),children:[(0,s.jsx)(e.icon,{className:"h-5 w-5 ".concat(r?"text-white":"text-gray-500")}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"font-medium ".concat(r?"text-white":"text-gray-900"),children:e.name}),(0,s.jsx)("div",{className:"text-xs ".concat(r?"text-blue-100":"text-gray-500"),children:e.description})]})]},e.id)})}),(0,s.jsx)("div",{className:"p-4 border-t border-gray-200",children:(0,s.jsxs)("div",{className:"text-xs text-gray-500 text-center",children:[(0,s.jsx)("div",{children:"WhatsApp Chatbot"}),(0,s.jsx)("div",{children:"V1.0.0"})]})})]})}var v=t(7842),j=t(9387),f=t(8059),N=t(1331),w=t(9035),C=t(5945),k=t(2342),_=t(9064);function E(){var e,a,t,n,i,o,d;let{systemStatus:m,onStatusChange:h}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[g,b]=(0,r.useState)("local"),[y,E]=(0,r.useState)(""),[S,A]=(0,r.useState)(""),[Z,P]=(0,r.useState)([]),[D,M]=(0,r.useState)(!1),[I,L]=(0,r.useState)(null),[O,F]=(0,r.useState)(null),[T,G]=(0,r.useState)("main");(0,r.useEffect)(()=>{B(),R(),W()},[g]);let R=async()=>{try{let[e,a]=await Promise.all([l.getCurrentModel(),l.getReasonerModel()]);E((null==e?void 0:e.model)||""),A((null==a?void 0:a.model)||"")}catch(e){console.error("Error loading current models:",e)}},B=async()=>{try{if("local"===g){let e=await l.getLMStudioModels(),a=(null==e?void 0:e.models)||[];P(Array.isArray(a)?a:[])}else{let e=await l.getAvailableOnlineModels(),a=[];for(let[t,s]of Object.entries(e))for(let e of s)a.push({...e,provider:t});P(a)}}catch(e){console.error("Error loading models:",e),_.ZP.error("Error al cargar modelos"),P([])}},W=async()=>{try{let[e,a]=await Promise.all([l.getSystemStatus(),l.getWhatsAppStatus()]);L(e),F(a)}catch(e){console.error("Error updating statuses:",e)}},z=async()=>{if("online"===g){_.ZP.error("Primero configura las API keys en la secci\xf3n de Configuraci\xf3n");return}M(!0);try{let e=await l.startLMStudio();"success"===e.status?_.ZP.success(e.message||"Iniciando LM Studio..."):_.ZP.error(e.message||"Error al iniciar LM Studio"),await W()}catch(e){_.ZP.error(e.message||"Error al iniciar LM Studio")}finally{M(!1)}},U=async()=>{M(!0);try{await l.stopLMStudioServer(),_.ZP.success("Deteniendo LM Studio..."),await W()}catch(e){_.ZP.error("Error al detener LM Studio")}finally{M(!1)}},q=async()=>{if(!y){_.ZP.error("Selecciona un modelo primero");return}M(!0);try{"local"===g&&await l.loadLMStudioModel(y),await l.setCurrentModel(y),_.ZP.success("Modelo principal cargado exitosamente"),W()}catch(e){_.ZP.error("Error al cargar modelo principal")}finally{M(!1)}},V=async()=>{if(!S){_.ZP.error("Selecciona un modelo reasoning primero");return}M(!0);try{await l.setReasonerModel(S),_.ZP.success("Modelo reasoning configurado exitosamente"),W()}catch(e){_.ZP.error("Error al configurar modelo reasoning")}finally{M(!1)}},X=async()=>{if("local"===g&&!((null==I?void 0:I.status)==="running"||(null==I?void 0:I.status)==="healthy")){_.ZP.error("Primero inicia el servidor de LM Studio");return}M(!0);try{await l.startWhatsApp(),_.ZP.success("Iniciando WhatsApp..."),setTimeout(W,3e3)}catch(e){_.ZP.error("Error al iniciar WhatsApp")}finally{M(!1)}},H=async()=>{M(!0);try{await l.stopWhatsApp(),_.ZP.success("Deteniendo WhatsApp..."),setTimeout(W,2e3)}catch(e){_.ZP.error("Error al detener WhatsApp")}finally{M(!1)}},Q=async()=>{M(!0);try{await l.stopAllServices(),_.ZP.success("Deteniendo todos los servicios..."),setTimeout(W,3e3)}catch(e){_.ZP.error("Error al detener servicios")}finally{M(!1)}},$=function(e){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return a?(0,s.jsx)(x.Z,{className:"h-5 w-5 text-yellow-500 animate-spin"}):e?(0,s.jsx)(u.Z,{className:"h-5 w-5 text-green-500"}):(0,s.jsx)(p.Z,{className:"h-5 w-5 text-red-500"})};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Panel de Control Principal"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Controla todos los servicios del chatbot desde aqu\xed"})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[(0,s.jsx)(c.Z,{className:"h-6 w-6 mr-2 text-blue-500"}),"1. Seleccionar Modo de Operaci\xf3n"]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("button",{onClick:()=>b("local"),className:"p-6 rounded-lg border-2 transition-all duration-200 ".concat("local"===g?"border-blue-500 bg-blue-50 shadow-lg transform scale-105":"border-gray-200 hover:border-gray-300 hover:shadow-md"),children:[(0,s.jsx)("div",{className:"flex items-center justify-center mb-3",children:(0,s.jsx)(j.Z,{className:"h-12 w-12 ".concat("local"===g?"text-blue-500":"text-gray-400")})}),(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2 ".concat("local"===g?"text-blue-900":"text-gray-700"),children:"Modelos Locales"}),(0,s.jsx)("p",{className:"text-sm ".concat("local"===g?"text-blue-700":"text-gray-500"),children:"Usar LM Studio y modelos descargados localmente"})]}),(0,s.jsxs)("button",{onClick:()=>b("online"),className:"p-6 rounded-lg border-2 transition-all duration-200 ".concat("online"===g?"border-blue-500 bg-blue-50 shadow-lg transform scale-105":"border-gray-200 hover:border-gray-300 hover:shadow-md"),children:[(0,s.jsx)("div",{className:"flex items-center justify-center mb-3",children:(0,s.jsx)(f.Z,{className:"h-12 w-12 ".concat("online"===g?"text-blue-500":"text-gray-400")})}),(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2 ".concat("online"===g?"text-blue-900":"text-gray-700"),children:"APIs Online"}),(0,s.jsx)("p",{className:"text-sm ".concat("online"===g?"text-blue-700":"text-gray-500"),children:"Usar OpenAI, Claude, Gemini, etc."})]})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[(0,s.jsx)(N.Z,{className:"h-6 w-6 mr-2 text-green-500"}),"2. ","local"===g?"Servidor LM Studio":"Configuraci\xf3n API"]}),"local"===g?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(e=>{switch(e){case"healthy":return(0,s.jsx)(u.Z,{className:"h-5 w-5 text-green-500"});case"warning":return(0,s.jsx)(v.Z,{className:"h-5 w-5 text-yellow-500"});case"critical":return(0,s.jsx)(p.Z,{className:"h-5 w-5 text-red-500"});default:return(0,s.jsx)(x.Z,{className:"h-5 w-5 text-gray-500"})}})((null==I?void 0:I.status)||"unknown"),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-gray-900",children:"Estado del Backend"}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t={healthy:"Servidor Saludable",warning:"Servidor con Advertencias",critical:"Servidor con Problemas Cr\xedticos",ok:"Servidor Funcionando"}[e]||"Estado Desconocido";return a&&a.length>0?"".concat(t," - ").concat(a[0]):t}((null==I?void 0:null===(e=I.server_health)||void 0===e?void 0:e.status)||(null==I?void 0:I.status)||"unknown",(null==I?void 0:null===(a=I.server_health)||void 0===a?void 0:a.issues)||[])})]})]}),(0,s.jsx)("div",{className:"text-xs text-gray-400",children:(null==I?void 0:null===(t=I.server_health)||void 0===t?void 0:t.timestamp)?"\xdaltimo check: ".concat(new Date(I.server_health.timestamp).toLocaleTimeString()):"Verificando..."})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[$(null==I?void 0:null===(n=I.lm_studio)||void 0===n?void 0:n.is_running,D),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-gray-900",children:"LM Studio"}),(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:[(null==I?void 0:null===(i=I.lm_studio)||void 0===i?void 0:i.status)||"Verificando...",(null==I?void 0:null===(o=I.lm_studio)||void 0===o?void 0:o.current_model)&&" - ".concat(I.lm_studio.current_model)]})]})]}),(0,s.jsxs)("div",{className:"space-x-2",children:[(0,s.jsxs)("button",{onClick:z,disabled:D||(null==I?void 0:null===(d=I.status)||void 0===d?void 0:d.includes("running")),className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:[(0,s.jsx)(w.Z,{className:"h-4 w-4 inline mr-1"}),"Iniciar"]}),(0,s.jsxs)("button",{onClick:U,disabled:D||!((null==I?void 0:I.status)==="running"||(null==I?void 0:I.status)==="healthy"),className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:[(0,s.jsx)(C.Z,{className:"h-4 w-4 inline mr-1"}),"Detener"]})]})]})]}):(0,s.jsx)("div",{className:"p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)(c.Z,{className:"h-5 w-5 text-yellow-600 mt-0.5 mr-2"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-yellow-800",children:"Configuraci\xf3n Requerida"}),(0,s.jsx)("div",{className:"text-sm text-yellow-700 mt-1",children:"Ve a la secci\xf3n de Configuraci\xf3n para agregar tus API keys"})]})]})})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[(0,s.jsx)(N.Z,{className:"h-6 w-6 mr-2 text-purple-500"}),"3. Configuraci\xf3n de Modelos"]}),(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)("div",{className:"border-b border-gray-200",children:(0,s.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,s.jsx)("button",{onClick:()=>G("main"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("main"===T?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Modelo Principal"}),(0,s.jsx)("button",{onClick:()=>G("reasoner"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("reasoner"===T?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Modelo Reasoning"})]})})}),(0,s.jsxs)("div",{className:"space-y-4",children:["main"===T&&(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:(0,s.jsxs)("p",{className:"text-sm text-blue-700",children:[(0,s.jsx)("strong",{children:"Modelo Principal:"})," Se usa para las conversaciones generales con los usuarios"]})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Modelo Principal Disponible"}),(0,s.jsxs)("select",{value:y,onChange:e=>E(e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 bg-white",children:[(0,s.jsx)("option",{value:"",className:"text-gray-500",children:"Seleccionar modelo principal..."}),Array.isArray(Z)&&Z.map(e=>(0,s.jsxs)("option",{value:e.name||e.id,className:"text-gray-900 bg-white",children:[e.name||e.id,e.provider&&" (".concat(e.provider,")")]},e.id||e.name))]})]}),(0,s.jsx)("button",{onClick:q,disabled:!y||D,className:"w-full py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:D?"Cargando...":"Configurar Modelo Principal"})]}),"reasoner"===T&&(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"mb-4 p-3 bg-purple-50 rounded-lg border border-purple-200",children:(0,s.jsxs)("p",{className:"text-sm text-purple-700",children:[(0,s.jsx)("strong",{children:"Modelo Reasoning:"})," Se usa para an\xe1lisis profundo y razonamiento estrat\xe9gico cada cierto n\xfamero de mensajes"]})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Modelo Reasoning Disponible"}),(0,s.jsxs)("select",{value:S,onChange:e=>A(e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-gray-900 bg-white",children:[(0,s.jsx)("option",{value:"",className:"text-gray-500",children:"Seleccionar modelo reasoning..."}),Array.isArray(Z)&&Z.map(e=>(0,s.jsxs)("option",{value:e.name||e.id,className:"text-gray-900 bg-white",children:[e.name||e.id,e.provider&&" (".concat(e.provider,")")]},"reasoner_".concat(e.id||e.name)))]})]}),(0,s.jsx)("button",{onClick:V,disabled:!S||D,className:"w-full py-3 bg-purple-500 text-white rounded-lg hover:bg-purple-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:D?"Configurando...":"Configurar Modelo Reasoning"}),(0,s.jsx)("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:(0,s.jsxs)("p",{className:"text-xs text-gray-600",children:["\uD83D\uDCA1 ",(0,s.jsx)("strong",{children:"Recomendaci\xf3n:"})," Usa un modelo m\xe1s potente para reasoning (como GPT-4 o Claude) y uno m\xe1s r\xe1pido para conversaciones generales."]})})]})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[(0,s.jsx)(k.Z,{className:"h-6 w-6 mr-2 text-green-500"}),"4. Control de WhatsApp"]}),(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[$((null==O?void 0:O.status)==="connected",D),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-gray-900",children:"Estado de WhatsApp"}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:(null==O?void 0:O.status)==="connected"?"Conectado y funcionando":"Desconectado"})]})]}),(0,s.jsxs)("div",{className:"space-x-2",children:[(0,s.jsxs)("button",{onClick:X,disabled:D||(null==O?void 0:O.status)==="connected",className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:[(0,s.jsx)(w.Z,{className:"h-4 w-4 inline mr-1"}),"Iniciar"]}),(0,s.jsxs)("button",{onClick:H,disabled:D||(null==O?void 0:O.status)!=="connected",className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:[(0,s.jsx)(C.Z,{className:"h-4 w-4 inline mr-1"}),"Detener"]})]})]})})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Control Global"}),(0,s.jsxs)("button",{onClick:Q,disabled:D,className:"w-full py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:[(0,s.jsx)(C.Z,{className:"h-5 w-5 inline mr-2"}),"Detener Todos los Servicios"]})]})]})}var S=t(9055),A=t(4670),Z=t(9672),P=t(9581),D=t(6310);function M(){let[e,a]=(0,r.useState)({}),[t,n]=(0,r.useState)({}),[i,o]=(0,r.useState)({perfil:"",ejemplo_chat:"",ultimo_contexto:""}),[d,m]=(0,r.useState)({openai:"",claude:"",gemini:""}),[x,b]=(0,r.useState)({temperature:.7,max_tokens:1e3,top_p:1}),[y,j]=(0,r.useState)(!0),[f,C]=(0,r.useState)(!1),[k,E]=(0,r.useState)(!1),[M,I]=(0,r.useState)({}),[L,O]=(0,r.useState)(!1),[F,T]=(0,r.useState)(!1),[G,R]=(0,r.useState)({}),[B,W]=(0,r.useState)({});(0,r.useEffect)(()=>{U(),z(),q()},[]);let z=async()=>{j(!0);try{let e=await l.getDocsContent();e&&o(e)}catch(e){console.error("Error loading docs content:",e),o({perfil:"",ejemplo_chat:"",ultimo_contexto:""})}finally{j(!1)}},U=async()=>{C(!0);try{let[e,t]=await Promise.all([l.getSettings(),l.getPrompts()]);a(e||{}),n(t||{}),e&&(b({temperature:e.temperature||.7,max_tokens:e.max_tokens||1e3,top_p:e.top_p||1}),e.api_keys&&m({openai:e.api_keys.openai||"",claude:e.api_keys.claude||"",gemini:e.api_keys.gemini||""}))}catch(e){console.error("Error loading configuration:",e),_.ZP.error("Error al cargar configuraci\xf3n")}finally{C(!1)}},q=async()=>{O(!0);try{let e=await l.getOnlineApisConfig();"success"===e.status&&I(e.config||{})}catch(e){console.error("Error loading online APIs config:",e)}finally{O(!1)}},V=async()=>{T(!0);try{let e=await l.saveOnlineApisConfig(M);"success"===e.status?(_.ZP.success("Configuraci\xf3n de APIs guardada exitosamente"),q()):_.ZP.error("Error al guardar: "+e.message)}catch(e){_.ZP.error("Error al guardar: "+e.message)}finally{T(!1)}},X=async e=>{W(a=>({...a,[e]:!0}));try{let a=await l.testOnlineApi(e);R(t=>({...t,[e]:a}))}catch(a){R(t=>({...t,[e]:{status:"error",message:a.message||"Error de conexi\xf3n"}}))}finally{W(a=>({...a,[e]:!1}))}},H=(e,a,t)=>{I(s=>({...s,[e]:{...s[e],[a]:t}}))},Q=e=>{switch(e){case"openai":return"\uD83E\uDD16";case"anthropic":return"\uD83E\uDDE0";case"google":return"\uD83D\uDC8E";default:return"\uD83D\uDD0C"}},$=e=>{switch(e){case"openai":return"OpenAI (ChatGPT)";case"anthropic":return"Anthropic (Claude)";case"google":return"Google (Gemini)";default:return e.charAt(0).toUpperCase()+e.slice(1)}},K=async()=>{E(!0);try{await l.saveSettings({...e,...x,api_keys:d}),_.ZP.success("Configuraci\xf3n guardada exitosamente")}catch(e){_.ZP.error("Error al guardar configuraci\xf3n")}finally{E(!1)}},J=async()=>{E(!0);try{await l.savePrompts(t),_.ZP.success("Prompts guardados exitosamente")}catch(e){_.ZP.error("Error al guardar prompts")}finally{E(!1)}},Y=async(e,a)=>{try{await l.saveFile(e,a),_.ZP.success("Archivo ".concat(e," guardado exitosamente")),z()}catch(a){_.ZP.error("Error al guardar ".concat(e))}};return f?(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-8 h-8 mx-auto mb-4 border-4 border-blue-500 rounded-full border-t-transparent animate-spin"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Cargando configuraci\xf3n..."})]})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"p-6 bg-white rounded-lg shadow-lg",children:[(0,s.jsxs)("h1",{className:"flex items-center mb-2 text-2xl font-bold text-gray-900",children:[(0,s.jsx)(c.Z,{className:"mr-3 text-blue-500 h-7 w-7"}),"Configuraci\xf3n del Sistema"]}),(0,s.jsx)("p",{className:"text-gray-600",children:"Configura API keys, par\xe1metros de modelos y prompts del sistema"})]}),(0,s.jsxs)("div",{className:"p-6 bg-white rounded-lg shadow-lg",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{className:"flex items-center text-xl font-semibold text-gray-900",children:[(0,s.jsx)(g.Z,{className:"w-6 h-6 mr-2 text-blue-500"}),"APIs Online"]}),(0,s.jsx)("p",{className:"mt-1 text-gray-600",children:"Configura y gestiona las conexiones a servicios de IA externos"})]}),(0,s.jsx)("button",{onClick:V,disabled:F,className:"flex items-center px-6 py-2 text-white transition-all duration-200 bg-blue-500 rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed",children:F?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-4 h-4 mr-2 border-b-2 border-white rounded-full animate-spin"}),"Guardando..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.Z,{className:"w-4 h-4 mr-2"}),"Guardar Configuraci\xf3n"]})})]}),(0,s.jsx)("div",{className:"p-4 mb-6 border border-blue-200 rounded-lg bg-blue-50",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(S.Z,{className:"w-5 h-5 mr-2 text-blue-600"}),(0,s.jsxs)("div",{className:"text-sm text-blue-800",children:[(0,s.jsx)("p",{className:"font-medium",children:"Informaci\xf3n importante:"}),(0,s.jsxs)("ul",{className:"mt-1 space-y-1 list-disc list-inside",children:[(0,s.jsx)("li",{children:"Las claves API se almacenan de forma segura localmente"}),(0,s.jsx)("li",{children:"Solo se muestran los \xfaltimos 4 caracteres por seguridad"}),(0,s.jsx)("li",{children:"Puedes habilitar m\xfaltiples proveedores simult\xe1neamente"}),(0,s.jsx)("li",{children:'Usa el bot\xf3n "Probar" para verificar la conectividad'})]})]})]})}),L?(0,s.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,s.jsx)("div",{className:"w-8 h-8 border-b-2 border-blue-500 rounded-full animate-spin"})}):(0,s.jsx)("div",{className:"grid grid-cols-1 gap-6",children:Object.entries(M).map(e=>{var a;let[t,r]=e;return(0,s.jsxs)("div",{className:"p-6 bg-white border-l-4 border-blue-300 rounded-lg shadow-sm",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("span",{className:"mr-3 text-2xl",children:Q(t)}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:$(t)}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:[(null===(a=r.models)||void 0===a?void 0:a.length)||0," modelos disponibles"]})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[G[t]&&(0,s.jsxs)("div",{className:"flex items-center text-sm px-2 py-1 rounded ".concat("success"===G[t].status?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:["success"===G[t].status?(0,s.jsx)(u.Z,{className:"w-4 h-4 mr-1"}):(0,s.jsx)(p.Z,{className:"w-4 h-4 mr-1"}),G[t].message]}),(0,s.jsx)("button",{onClick:()=>X(t),disabled:B[t]||!r.has_api_key,className:"flex items-center px-3 py-1 text-sm text-white transition-all duration-200 bg-purple-500 rounded hover:bg-purple-600 disabled:opacity-50 disabled:cursor-not-allowed",children:B[t]?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-3 h-3 mr-1 border-b-2 border-white rounded-full animate-spin"}),"Probando..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(w.Z,{className:"w-3 h-3 mr-1"}),"Probar"]})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-gray-50",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Habilitado"}),(0,s.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",checked:r.enabled,onChange:e=>H(t,"enabled",e.target.checked),className:"sr-only peer"}),(0,s.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:[(0,s.jsx)(A.Z,{className:"inline w-4 h-4 mr-1"}),"Clave API"]}),(0,s.jsx)("input",{type:"password",value:r.api_key_masked||"",onChange:e=>H(t,"api_key",e.target.value),placeholder:"Ingresa tu clave API",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),r.has_api_key&&(0,s.jsx)("p",{className:"mt-1 text-xs text-green-600",children:"âœ“ Clave API configurada"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"URL Base"}),(0,s.jsx)("input",{type:"text",value:r.base_url,onChange:e=>H(t,"base_url",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:[(0,s.jsx)(N.Z,{className:"inline w-4 h-4 mr-1"}),"Modelos Disponibles"]}),(0,s.jsx)("div",{className:"p-3 space-y-2 overflow-y-auto rounded-lg max-h-32 bg-gray-50",children:r.models&&r.models.length>0?r.models.map((e,a)=>(0,s.jsxs)("div",{className:"flex items-center text-sm",children:[(0,s.jsx)("div",{className:"w-2 h-2 mr-2 bg-blue-500 rounded-full"}),(0,s.jsx)("span",{children:e})]},a)):(0,s.jsx)("div",{className:"py-2 text-sm text-center text-gray-500",children:"No hay modelos configurados"})})]}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)("div",{className:"p-3 rounded-lg border ".concat(r.enabled&&r.has_api_key?"border-green-200 bg-green-50":"border-yellow-200 bg-yellow-50"),children:(0,s.jsx)("div",{className:"flex items-center",children:r.enabled&&r.has_api_key?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.Z,{className:"w-5 h-5 mr-2 text-green-500"}),(0,s.jsx)("span",{className:"text-sm font-medium text-green-700",children:"Configurado y listo"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v.Z,{className:"w-5 h-5 mr-2 text-yellow-500"}),(0,s.jsx)("span",{className:"text-sm font-medium text-yellow-700",children:r.enabled?"Falta clave API":"Deshabilitado"})]})})})})]})]})]},t)})}),0===Object.keys(M).length&&!L&&(0,s.jsxs)("div",{className:"p-12 text-center bg-white border-2 border-gray-300 border-dashed rounded-lg",children:[(0,s.jsx)(g.Z,{className:"w-16 h-16 mx-auto mb-4 text-gray-400"}),(0,s.jsx)("h3",{className:"mb-2 text-lg font-medium text-gray-900",children:"No hay configuraci\xf3n de APIs"}),(0,s.jsx)("p",{className:"text-gray-500",children:"La configuraci\xf3n de APIs online se cargar\xe1 autom\xe1ticamente cuando est\xe9 disponible."})]})]}),(0,s.jsxs)("div",{className:"p-6 bg-white rounded-lg shadow-lg",children:[(0,s.jsxs)("h2",{className:"flex items-center mb-4 text-xl font-semibold text-gray-900",children:[(0,s.jsx)(h.Z,{className:"w-6 h-6 mr-2 text-purple-500"}),"Configuraci\xf3n de Modelos"]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:["Temperatura: ",(0,s.jsx)("span",{className:"font-bold text-blue-600",children:x.temperature}),(0,s.jsx)("span",{className:"ml-1 text-xs text-gray-500",children:"(0.0 - 2.0)"})]}),(0,s.jsx)("input",{type:"range",min:"0",max:"2",step:"0.1",value:x.temperature,onChange:e=>b(a=>({...a,temperature:parseFloat(e.target.value)})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider",style:{background:"linear-gradient(to right, #3B82F6 0%, #3B82F6 ".concat(x.temperature/2*100,"%, #D1D5DB ").concat(x.temperature/2*100,"%, #D1D5DB 100%)")}}),(0,s.jsxs)("div",{className:"flex justify-between mt-1 text-xs text-gray-500",children:[(0,s.jsx)("span",{children:"Preciso"}),(0,s.jsx)("span",{children:"Creativo"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:["Max Tokens: ",(0,s.jsx)("span",{className:"font-bold text-green-600",children:x.max_tokens}),(0,s.jsx)("span",{className:"ml-1 text-xs text-gray-500",children:"(50 - 4000)"})]}),(0,s.jsx)("input",{type:"range",min:"50",max:"4000",step:"50",value:x.max_tokens,onChange:e=>b(a=>({...a,max_tokens:parseInt(e.target.value)})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider",style:{background:"linear-gradient(to right, #10B981 0%, #10B981 ".concat((x.max_tokens-50)/3950*100,"%, #D1D5DB ").concat((x.max_tokens-50)/3950*100,"%, #D1D5DB 100%)")}}),(0,s.jsxs)("div",{className:"flex justify-between mt-1 text-xs text-gray-500",children:[(0,s.jsx)("span",{children:"50"}),(0,s.jsx)("span",{children:"4000"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:["Top P: ",(0,s.jsx)("span",{className:"font-bold text-purple-600",children:x.top_p}),(0,s.jsx)("span",{className:"ml-1 text-xs text-gray-500",children:"(0.0 - 1.0)"})]}),(0,s.jsx)("input",{type:"range",min:"0",max:"1",step:"0.1",value:x.top_p,onChange:e=>b(a=>({...a,top_p:parseFloat(e.target.value)})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider",style:{background:"linear-gradient(to right, #8B5CF6 0%, #8B5CF6 ".concat(100*x.top_p,"%, #D1D5DB ").concat(100*x.top_p,"%, #D1D5DB 100%)")}}),(0,s.jsxs)("div",{className:"flex justify-between mt-1 text-xs text-gray-500",children:[(0,s.jsx)("span",{children:"Determin\xedstico"}),(0,s.jsx)("span",{children:"Diverso"})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:["Reasoning cada X mensajes",(0,s.jsx)("span",{className:"ml-1 text-xs text-gray-500",children:"(1 - 50)"})]}),(0,s.jsx)("input",{type:"number",min:"1",max:"50",value:e.reason_after_messages||10,onChange:e=>a(a=>({...a,reason_after_messages:parseInt(e.target.value)})),className:"w-full p-3 text-gray-900 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",id:"respond-to-all",checked:e.respond_to_all||!1,onChange:e=>a(a=>({...a,respond_to_all:e.target.checked})),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,s.jsxs)("label",{htmlFor:"respond-to-all",className:"block ml-2 text-sm text-gray-900",children:[(0,s.jsx)("span",{className:"font-medium",children:"Responder a TODOS los mensajes"}),(0,s.jsx)("span",{className:"block text-xs text-gray-500",children:"No solo a contactos de la lista"})]})]})]})]}),(0,s.jsxs)("div",{className:"p-6 bg-white rounded-lg shadow-lg",children:[(0,s.jsxs)("h2",{className:"flex items-center mb-4 text-xl font-semibold text-gray-900",children:[(0,s.jsx)(Z.Z,{className:"w-6 h-6 mr-2 text-indigo-500"}),"Configuraci\xf3n de Prompts y Documentaci\xf3n"]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"\uD83E\uDD16 Perfil del Asistente"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:"px-2 py-1 text-xs text-gray-500 bg-blue-100 rounded",children:"Docs/Perfil.txt"}),(0,s.jsx)("button",{onClick:()=>Y("perfil",i.perfil),className:"px-3 py-1 text-xs text-white transition-colors bg-blue-500 rounded hover:bg-blue-600",children:"\uD83D\uDCBE Guardar"})]})]}),(0,s.jsx)("p",{className:"mb-2 text-xs text-gray-600",children:"Define la personalidad, especialidades y comportamiento del chatbot m\xe9dico"}),(0,s.jsx)("textarea",{value:y?"":i.perfil,onChange:e=>o(a=>({...a,perfil:e.target.value})),rows:8,className:"w-full p-3 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:y?"Cargando contenido del perfil...":"Escribe el perfil del asistente...",disabled:y})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"\uD83D\uDCAC Ejemplos de Conversaciones"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:"px-2 py-1 text-xs text-gray-500 bg-green-100 rounded",children:"Docs/ejemplo_chat.txt"}),(0,s.jsx)("button",{onClick:()=>Y("ejemplo_chat",i.ejemplo_chat),className:"px-3 py-1 text-xs text-white transition-colors bg-green-500 rounded hover:bg-green-600",children:"\uD83D\uDCBE Guardar"})]})]}),(0,s.jsx)("p",{className:"mb-2 text-xs text-gray-600",children:"Patrones y ejemplos de interacciones exitosas para entrenar al modelo"}),(0,s.jsx)("textarea",{value:y?"":i.ejemplo_chat,onChange:e=>o(a=>({...a,ejemplo_chat:e.target.value})),rows:12,className:"w-full p-3 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:y?"Cargando ejemplos de conversaciones...":"Escribe ejemplos de conversaciones...",disabled:y})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"\uD83D\uDCCA Contexto y Estado Actual"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:"px-2 py-1 text-xs text-gray-500 bg-purple-100 rounded",children:"Docs/Ultimo_contexto.txt"}),(0,s.jsx)("button",{onClick:()=>Y("ultimo_contexto",i.ultimo_contexto),className:"px-3 py-1 text-xs text-white transition-colors bg-purple-500 rounded hover:bg-purple-600",children:"\uD83D\uDCBE Guardar"})]})]}),(0,s.jsx)("p",{className:"mb-2 text-xs text-gray-600",children:"Informaci\xf3n actualizada sobre servicios, horarios y estado del sistema"}),(0,s.jsx)("textarea",{value:y?"":i.ultimo_contexto,onChange:e=>o(a=>({...a,ultimo_contexto:e.target.value})),rows:10,className:"w-full p-3 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:y?"Cargando contexto actual...":"Escribe el contexto actual...",disabled:y})]}),(0,s.jsx)("div",{className:"p-4 rounded-lg bg-gray-50",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:"Sincronizar Documentaci\xf3n"}),(0,s.jsx)("p",{className:"text-xs text-gray-600",children:"Recargar contenido desde los archivos Docs/"})]}),(0,s.jsx)("button",{onClick:z,className:"px-4 py-2 text-sm text-white transition-colors bg-indigo-500 rounded-lg hover:bg-indigo-600",children:"\uD83D\uDD04 Recargar Docs"})]})})]})]}),(0,s.jsx)("div",{className:"p-6 bg-white rounded-lg shadow-lg",children:(0,s.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row",children:[(0,s.jsxs)("button",{onClick:K,disabled:k,className:"flex items-center justify-center flex-1 px-6 py-3 text-white transition-all duration-200 bg-blue-500 rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)(P.Z,{className:"w-5 h-5 mr-2"}),k?"Guardando...":"Guardar Configuraci\xf3n"]}),(0,s.jsxs)("button",{onClick:J,disabled:k,className:"flex items-center justify-center flex-1 px-6 py-3 text-white transition-all duration-200 bg-green-500 rounded-lg hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)(Z.Z,{className:"w-5 h-5 mr-2"}),k?"Guardando...":"Guardar Prompts"]}),(0,s.jsxs)("button",{onClick:()=>{b({temperature:.7,max_tokens:1e3,top_p:1}),m({openai:"",claude:"",gemini:""}),_.ZP.success("Configuraci\xf3n restablecida a valores por defecto")},className:"flex items-center justify-center flex-1 px-6 py-3 text-white transition-all duration-200 bg-gray-500 rounded-lg hover:bg-gray-600",children:[(0,s.jsx)(D.Z,{className:"w-5 h-5 mr-2"}),"Restablecer"]})]})})]})}var I=t(1556),L=t(3836),O=t(2087),F=t(9967),T=t(8931),G=t(7442),R=t(3767),B=t(2594),W=t(1601);function z(){var e;let[a,t]=(0,r.useState)([]),[n,i]=(0,r.useState)(!1),[o,c]=(0,r.useState)(""),[m,h]=(0,r.useState)(!1),[x,u]=(0,r.useState)(!1),[g,p]=(0,r.useState)([]),[b,y]=(0,r.useState)(!1),[v,j]=(0,r.useState)(!1),[f,N]=(0,r.useState)({contactId:"",objective:"",context:"",generatedMessage:""}),[w,C]=(0,r.useState)(!1),[k,E]=(0,r.useState)(null),[S,A]=(0,r.useState)(!1),[Z,P]=(0,r.useState)(null),[M,z]=(0,r.useState)([]),[U,q]=(0,r.useState)({name:"",phone:"",chatId:""}),[V,X]=(0,r.useState)({contactId:"",message:""}),[H,Q]=(0,r.useState)({message:"",intervalSeconds:5,objective:"",useAI:!1,template:"",personalizePerContact:!1});(0,r.useEffect)(()=>{K(),$()},[]);let $=async()=>{try{let e=await l.listMedia();"success"===e.status&&z(e.files||[])}catch(e){console.error("Error loading media files:",e)}},K=async()=>{i(!0);try{let e=await l.getAllowedContacts();t(e||[])}catch(e){console.error("Error loading contacts:",e),_.ZP.error("Error al cargar contactos")}finally{i(!1)}},J=async()=>{if(!U.name||!U.phone){_.ZP.error("Nombre y tel\xe9fono son requeridos");return}try{let e=U.chatId||U.phone;await l.addAllowedContact({chat_id:e,perfil:U.name,context:"",objective:""}),_.ZP.success("Contacto agregado exitosamente"),q({name:"",phone:"",chatId:""}),h(!1),K()}catch(e){_.ZP.error("Error al agregar contacto")}},Y=async e=>{if(confirm("\xbfEst\xe1s seguro de que quieres eliminar este contacto?"))try{await l.removeAllowedContact(e),_.ZP.success("Contacto eliminado exitosamente"),K()}catch(e){_.ZP.error("Error al eliminar contacto")}},ee=e=>{E(e),C(!0)},ea=async()=>{if(k)try{await l.updateAllowedContact(k.chat_id,{perfil:k.contact_name,context:k.context||"",objective:k.objective||""}),_.ZP.success("Contacto actualizado exitosamente"),C(!1),E(null),K()}catch(e){_.ZP.error("Error al actualizar contacto")}},et=async()=>{if(!V.contactId||!V.message){_.ZP.error("Selecciona un contacto y escribe un mensaje");return}try{let e=a.find(e=>e.chat_id===V.contactId);await l.sendWhatsAppMessage((null==e?void 0:e.chat_id)||V.contactId,V.message),_.ZP.success("Mensaje enviado exitosamente"),X({contactId:"",message:""})}catch(e){_.ZP.error("Error al enviar mensaje")}},es=async()=>{if(!f.contactId||!f.objective){_.ZP.error("Selecciona un contacto y define el objetivo");return}j(!0);try{let e=await l.composeMessage(f.contactId,f.objective,f.context);"success"===e.status?(N(a=>({...a,generatedMessage:e.message})),_.ZP.success("Mensaje generado exitosamente")):_.ZP.error("Error al generar mensaje: "+e.message)}catch(e){_.ZP.error("Error al componer mensaje con IA")}finally{j(!1)}},er=async()=>{if(!f.contactId||!f.generatedMessage){_.ZP.error("No hay mensaje generado para enviar");return}try{await l.sendWhatsAppMessage(f.contactId,f.generatedMessage),_.ZP.success("Mensaje enviado exitosamente"),N({contactId:"",objective:"",context:"",generatedMessage:""}),y(!1)}catch(e){_.ZP.error("Error al enviar mensaje")}},en=async()=>{if(0===g.length){_.ZP.error("Selecciona al menos un contacto");return}if(!H.useAI&&!H.message){_.ZP.error("Escribe un mensaje o activa la personalizaci\xf3n con IA");return}if(H.useAI&&(!H.objective||!H.template)){_.ZP.error("Define el objetivo y la plantilla para la personalizaci\xf3n con IA");return}try{_.ZP.success("Iniciando env\xedo a ".concat(g.length," contactos..."));let e=0,t=0;for(let s of g)try{let t=H.message;if(H.useAI&&H.personalizePerContact){let e=a.find(e=>e.chat_id===s),r=e?"Contacto: ".concat(e.contact_name||"Sin nombre"):"";try{let a=await l.composeMessage(s,H.objective,"".concat(H.template,"\n\nContexto del contacto: ").concat(r));t="success"===a.status?a.message:H.template.replace("{nombre}",(null==e?void 0:e.contact_name)||"Cliente")}catch(a){console.error("Error generando mensaje personalizado para ".concat(s,":"),a),t=H.template.replace("{nombre}",(null==e?void 0:e.contact_name)||"Cliente")}}else H.useAI&&(t=H.template);await l.sendWhatsAppMessage(s,t),e++,_.ZP.success("Enviado ".concat(e,"/").concat(g.length),{duration:1e3}),e<g.length&&await new Promise(e=>setTimeout(e,1e3*H.intervalSeconds))}catch(e){console.error("Error enviando mensaje a ".concat(s,":"),e),t++}0===t?_.ZP.success("âœ… Todos los mensajes enviados exitosamente (".concat(e,"/").concat(g.length,")")):_.ZP.error("âš ï¸ Enviados: ".concat(e,", Errores: ").concat(t)),Q({message:"",intervalSeconds:5,objective:"",useAI:!1,template:"",personalizePerContact:!1}),p([]),u(!1)}catch(e){_.ZP.error("Error al enviar mensajes masivos")}},ei=a.filter(e=>{var a,t,s;return(null===(a=e.contact_name)||void 0===a?void 0:a.toLowerCase().includes(o.toLowerCase()))||(null===(t=e.phone_number)||void 0===t?void 0:t.includes(o))||(null===(s=e.chat_id)||void 0===s?void 0:s.includes(o))}),el=e=>{p(a=>a.includes(e)?a.filter(a=>a!==e):[...a,e])};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,s.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 mb-2 flex items-center",children:[(0,s.jsx)(d.Z,{className:"h-7 w-7 mr-3 text-blue-500"}),"Gesti\xf3n de Contactos"]}),(0,s.jsx)("p",{className:"text-gray-600",children:"Administra contactos, env\xeda mensajes individuales y campa\xf1as masivas"})]}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,s.jsxs)("div",{className:"flex-1 relative",children:[(0,s.jsx)(I.Z,{className:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,s.jsx)("input",{type:"text",value:o,onChange:e=>c(e.target.value),placeholder:"Buscar contactos...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("button",{onClick:()=>h(!m),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all duration-200 flex items-center",children:[(0,s.jsx)(L.Z,{className:"h-4 w-4 mr-1"}),"Agregar"]}),(0,s.jsxs)("button",{onClick:()=>y(!b),className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-all duration-200 flex items-center",children:[(0,s.jsx)(O.Z,{className:"h-4 w-4 mr-1"}),"Componer con IA"]}),(0,s.jsxs)("button",{onClick:()=>A(!S),className:"px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-all duration-200 flex items-center",children:[(0,s.jsx)(F.Z,{className:"h-4 w-4 mr-1"}),"Multimedia"]}),(0,s.jsxs)("button",{onClick:()=>u(!x),className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-all duration-200 flex items-center",children:[(0,s.jsx)(T.Z,{className:"h-4 w-4 mr-1"}),"Mensaje Masivo"]})]})]})}),m&&(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Agregar Nuevo Contacto"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsx)("input",{type:"text",value:U.name,onChange:e=>q(a=>({...a,name:e.target.value})),placeholder:"Nombre del contacto",className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,s.jsx)("input",{type:"text",value:U.phone,onChange:e=>q(a=>({...a,phone:e.target.value})),placeholder:"N\xfamero de tel\xe9fono",className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,s.jsx)("input",{type:"text",value:U.chatId,onChange:e=>q(a=>({...a,chatId:e.target.value})),placeholder:"Chat ID (opcional)",className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,s.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,s.jsx)("button",{onClick:J,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all duration-200",children:"Agregar Contacto"}),(0,s.jsx)("button",{onClick:()=>h(!1),className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-all duration-200",children:"Cancelar"})]})]}),b&&(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,s.jsx)(O.Z,{className:"h-5 w-5 mr-2 text-purple-500"}),"Componer Mensaje con IA"]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Seleccionar Contacto"}),(0,s.jsxs)("select",{value:f.contactId,onChange:e=>N(a=>({...a,contactId:e.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"Selecciona un contacto..."}),a.map(e=>(0,s.jsxs)("option",{value:e.chat_id,children:[e.contact_name," (",e.phone_number,")"]},e.chat_id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Objetivo del Mensaje"}),(0,s.jsx)("input",{type:"text",value:f.objective,onChange:e=>N(a=>({...a,objective:e.target.value})),placeholder:"ej: Agendar una cita m\xe9dica, Promocionar un producto, Seguimiento de venta...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contexto Adicional (opcional)"}),(0,s.jsx)("textarea",{value:f.context,onChange:e=>N(a=>({...a,context:e.target.value})),rows:3,placeholder:"Informaci\xf3n adicional que ayude a personalizar el mensaje...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),f.generatedMessage&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mensaje Generado"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("textarea",{value:f.generatedMessage,onChange:e=>N(a=>({...a,generatedMessage:e.target.value})),rows:4,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent bg-purple-50"}),(0,s.jsx)("button",{onClick:es,disabled:v,className:"absolute top-2 right-2 p-1 text-purple-500 hover:bg-purple-100 rounded transition-colors",title:"Regenerar mensaje",children:(0,s.jsx)(D.Z,{className:"h-4 w-4 ".concat(v?"animate-spin":"")})})]})]}),(0,s.jsxs)("div",{className:"flex gap-2 pt-4",children:[f.generatedMessage?(0,s.jsxs)("button",{onClick:er,className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-all duration-200 flex items-center",children:[(0,s.jsx)(G.Z,{className:"h-4 w-4 mr-2"}),"Enviar Mensaje"]}):(0,s.jsx)("button",{onClick:es,disabled:!f.contactId||!f.objective||v,className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center",children:v?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(D.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Generando..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(O.Z,{className:"h-4 w-4 mr-2"}),"Generar Mensaje"]})}),(0,s.jsx)("button",{onClick:()=>{y(!1),N({contactId:"",objective:"",context:"",generatedMessage:""})},className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-all duration-200",children:"Cancelar"})]})]})]}),x&&(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Campa\xf1a de Mensaje Masivo"}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"border border-blue-200 rounded-lg p-4 bg-blue-50",children:[(0,s.jsxs)("div",{className:"flex items-center mb-3",children:[(0,s.jsx)("input",{type:"checkbox",id:"useAI",checked:H.useAI,onChange:e=>Q(a=>({...a,useAI:e.target.checked})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,s.jsx)("label",{htmlFor:"useAI",className:"ml-2 text-sm font-medium text-blue-900",children:"\uD83E\uDD16 Usar AI para personalizar mensajes"})]}),H.useAI&&(0,s.jsxs)("div",{className:"space-y-3 mt-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-blue-700 mb-1",children:["Plantilla base (usa variables como ","{nombre}",", ","{empresa}",", etc.)"]}),(0,s.jsx)("textarea",{value:H.template,onChange:e=>Q(a=>({...a,template:e.target.value})),rows:3,placeholder:"Hola {nombre}, espero que est\xe9s bien. Quer\xeda contactarte para...",className:"w-full p-2 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-blue-700 mb-1",children:"Objetivo del mensaje"}),(0,s.jsx)("input",{type:"text",value:H.objective,onChange:e=>Q(a=>({...a,objective:e.target.value})),placeholder:"Ej: Promocionar servicio de citas m\xe9dicas, seguimiento postventa, etc.",className:"w-full p-2 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",id:"personalizePerContact",checked:H.personalizePerContact,onChange:e=>Q(a=>({...a,personalizePerContact:e.target.checked})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,s.jsx)("label",{htmlFor:"personalizePerContact",className:"ml-2 text-sm text-blue-700",children:"Personalizar cada mensaje individualmente (m\xe1s lento pero m\xe1s efectivo)"})]})]})]}),!H.useAI&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mensaje"}),(0,s.jsx)("textarea",{value:H.message,onChange:e=>Q(a=>({...a,message:e.target.value})),rows:4,placeholder:"Escribe tu mensaje aqu\xed...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Intervalo entre mensajes (segundos)"}),(0,s.jsx)("input",{type:"number",value:H.intervalSeconds,onChange:e=>Q(a=>({...a,intervalSeconds:parseInt(e.target.value)})),min:"1",max:"60",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Contactos seleccionados: ",g.length]}),(0,s.jsx)("div",{className:"p-3 bg-gray-50 rounded-lg text-sm text-gray-600",children:0===g.length?"Selecciona contactos de la lista":"".concat(g.length," contacto(s) seleccionado(s)")})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("button",{onClick:en,disabled:0===g.length||(H.useAI?!H.template||!H.objective:!H.message),className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center",children:[(0,s.jsx)(G.Z,{className:"h-4 w-4 mr-1"}),H.useAI?"\uD83E\uDD16 Enviar con AI":"Enviar Campa\xf1a"]}),(0,s.jsx)("button",{onClick:()=>u(!1),className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-all duration-200",children:"Cancelar"})]})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Lista de Contactos (",ei.length,")"]}),ei.length>0&&(0,s.jsx)("button",{onClick:()=>{g.length===ei.length?p([]):p(ei.map(e=>e.chat_id))},className:"text-sm text-blue-500 hover:text-blue-600",children:g.length===ei.length?"Deseleccionar todos":"Seleccionar todos"})]}),n?(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Cargando contactos..."})]}):0===ei.length?(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)(d.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"No hay contactos disponibles"})]}):(0,s.jsx)("div",{className:"space-y-3",children:ei.map(e=>(0,s.jsx)("div",{className:"p-4 border rounded-lg transition-all duration-200 ".concat(g.includes(e.chat_id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("input",{type:"checkbox",checked:g.includes(e.chat_id),onChange:()=>el(e.chat_id),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-gray-900",children:e.contact_name}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:e.phone_number}),(0,s.jsxs)("div",{className:"text-xs text-gray-400",children:["ID: ",e.chat_id]})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("button",{onClick:()=>{N(a=>({...a,contactId:e.chat_id})),y(!0)},className:"p-2 text-purple-500 hover:bg-purple-100 rounded-lg transition-all duration-200",title:"Componer con IA",children:(0,s.jsx)(O.Z,{className:"h-4 w-4"})}),(0,s.jsx)("button",{onClick:()=>X(a=>({...a,contactId:e.chat_id})),className:"p-2 text-blue-500 hover:bg-blue-100 rounded-lg transition-all duration-200",title:"Enviar mensaje",children:(0,s.jsx)(R.Z,{className:"h-4 w-4"})}),(0,s.jsx)("button",{onClick:()=>ee(e),className:"p-2 text-green-500 hover:bg-green-100 rounded-lg transition-all duration-200",title:"Editar contacto",children:(0,s.jsx)(B.Z,{className:"h-4 w-4"})}),(0,s.jsx)("button",{onClick:()=>Y(e.chat_id),className:"p-2 text-red-500 hover:bg-red-100 rounded-lg transition-all duration-200",title:"Eliminar contacto",children:(0,s.jsx)(W.Z,{className:"h-4 w-4"})})]})]})},e.chat_id))})]}),V.contactId&&(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Enviar Mensaje Individual"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contacto seleccionado"}),(0,s.jsx)("div",{className:"p-3 bg-gray-50 rounded-lg",children:(null===(e=a.find(e=>e.chat_id===V.contactId))||void 0===e?void 0:e.contact_name)||"Contacto no encontrado"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mensaje"}),(0,s.jsx)("textarea",{value:V.message,onChange:e=>X(a=>({...a,message:e.target.value})),rows:4,placeholder:"Escribe tu mensaje aqu\xed...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("button",{onClick:et,disabled:!V.message,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center",children:[(0,s.jsx)(G.Z,{className:"h-4 w-4 mr-1"}),"Enviar Mensaje"]}),(0,s.jsx)("button",{onClick:()=>X({contactId:"",message:""}),className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-all duration-200",children:"Cancelar"})]})]})]}),w&&k&&(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Editar Contacto"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre del Contacto"}),(0,s.jsx)("input",{type:"text",value:k.contact_name||"",onChange:e=>E({...k,contact_name:e.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Perfil"}),(0,s.jsx)("textarea",{value:k.perfil||"",onChange:e=>E({...k,perfil:e.target.value}),rows:3,placeholder:"Informaci\xf3n del perfil del contacto...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contexto"}),(0,s.jsx)("textarea",{value:k.context||"",onChange:e=>E({...k,context:e.target.value}),rows:3,placeholder:"Contexto adicional del contacto...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Objetivo"}),(0,s.jsx)("textarea",{value:k.objective||"",onChange:e=>E({...k,objective:e.target.value}),rows:3,placeholder:"Objetivo de la conversaci\xf3n...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("button",{onClick:ea,className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-all duration-200 flex items-center",children:[(0,s.jsx)(B.Z,{className:"h-4 w-4 mr-1"}),"Guardar Cambios"]}),(0,s.jsx)("button",{onClick:()=>{C(!1),E(null)},className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-all duration-200",children:"Cancelar"})]})]})]})]})}var U=t(2174),q=t(6705),V=t(4084);function X(){var e,a,t,n,i,o,c,d,h,g,b,y,v,j,f,w,C,k,_,E,S,A,Z,P;let[D,M]=(0,r.useState)({}),[I,L]=(0,r.useState)({}),[O,F]=(0,r.useState)([]),[G,B]=(0,r.useState)(!1),[W,z]=(0,r.useState)(!0),[V,X]=(0,r.useState)(new Date);(0,r.useEffect)(()=>{H();let e=setInterval(H,W?5e3:3e4);return()=>{clearInterval(e)}},[W]);let H=async()=>{B(!0);try{let[e,a]=await Promise.all([l.getAnalytics(),l.getSystemStatus()]);M(e||{}),L(a||{})}catch(e){console.error("Error loading statistics:",e)}finally{B(!1)}},Q={labels:(null===(e=D.conversations_by_day)||void 0===e?void 0:e.map(e=>e.date))||[],datasets:[{label:"Mensajes por d\xeda",data:(null===(a=D.conversations_by_day)||void 0===a?void 0:a.map(e=>e.count))||[],borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4}]},$={labels:(null===(t=D.top_users)||void 0===t?void 0:t.map(e=>e.user))||[],datasets:[{label:"Mensajes",data:(null===(n=D.top_users)||void 0===n?void 0:n.map(e=>e.messages))||[],backgroundColor:["rgba(59, 130, 246, 0.8)","rgba(16, 185, 129, 0.8)","rgba(245, 101, 101, 0.8)","rgba(251, 191, 36, 0.8)","rgba(139, 92, 246, 0.8)"]}]},K={responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,s.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 mb-2 flex items-center",children:[(0,s.jsx)(m.Z,{className:"h-7 w-7 mr-3 text-blue-500"}),"Estad\xedsticas y Monitoreo"]}),(0,s.jsx)("p",{className:"text-gray-600",children:"M\xe9tricas de rendimiento, uso del sistema y an\xe1lisis de conversaciones"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"p-3 rounded-full bg-blue-100",children:(0,s.jsx)(R.Z,{className:"h-8 w-8 text-blue-600"})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Mensajes Enviados"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:D.total_messages||0})]})]})}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"p-3 rounded-full bg-green-100",children:(0,s.jsx)(T.Z,{className:"h-8 w-8 text-green-600"})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Usuarios Activos"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:D.total_users||0})]})]})}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"p-3 rounded-full bg-purple-100",children:(0,s.jsx)(x.Z,{className:"h-8 w-8 text-purple-600"})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Tiempo Activo"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:(e=>{let a=Math.floor(e/86400),t=Math.floor(e%86400/3600),s=Math.floor(e%3600/60);return a>0?"".concat(a,"d ").concat(t,"h ").concat(s,"m"):t>0?"".concat(t,"h ").concat(s,"m"):"".concat(s,"m")})((null===(i=I.system)||void 0===i?void 0:i.uptime)||0)})]})]})}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"p-3 rounded-full bg-yellow-100",children:(0,s.jsx)(U.Z,{className:"h-8 w-8 text-yellow-600"})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Tasa de \xc9xito"}),(0,s.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:[((1-((null===(o=I.performance)||void 0===o?void 0:o.error_rate)||0))*100).toFixed(1),"%"]})]})]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Mensajes por D\xeda"}),(null===(c=D.conversations_by_day)||void 0===c?void 0:c.length)>0?(0,s.jsx)(q.x1,{data:Q,options:K}):(0,s.jsxs)("div",{className:"h-64 flex flex-col items-center justify-center text-gray-500 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[(0,s.jsx)(R.Z,{className:"h-16 w-16 text-gray-400 mb-4"}),(0,s.jsx)("p",{className:"text-lg font-medium text-gray-600 mb-2",children:"Sin datos de mensajes"}),(0,s.jsx)("p",{className:"text-sm text-center text-gray-500 max-w-xs",children:"Los datos de mensajes aparecer\xe1n aqu\xed una vez que el bot comience a procesar conversaciones"})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Usuarios M\xe1s Activos"}),(null===(d=D.top_users)||void 0===d?void 0:d.length)>0?(0,s.jsx)(q.$Q,{data:$,options:K}):(0,s.jsxs)("div",{className:"h-64 flex flex-col items-center justify-center text-gray-500 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[(0,s.jsx)(T.Z,{className:"h-16 w-16 text-gray-400 mb-4"}),(0,s.jsx)("p",{className:"text-lg font-medium text-gray-600 mb-2",children:"Sin actividad de usuarios"}),(0,s.jsx)("p",{className:"text-sm text-center text-gray-500 max-w-xs",children:"Las estad\xedsticas de usuarios aparecer\xe1n cuando empiecen las conversaciones"})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Rendimiento del Sistema"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{children:"CPU"}),(0,s.jsxs)("span",{children:[(null===(h=I.system)||void 0===h?void 0:h.cpu_usage)||0,"%"]})]}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,s.jsx)("div",{className:"h-2 rounded-full ".concat(((null===(g=I.system)||void 0===g?void 0:g.cpu_usage)||0)>80?"bg-red-500":"bg-green-500"),style:{width:"".concat((null===(b=I.system)||void 0===b?void 0:b.cpu_usage)||0,"%")}})})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{children:"Memoria"}),(0,s.jsxs)("span",{children:[(null===(y=I.system)||void 0===y?void 0:y.memory_usage)||0," MB"]})]}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,s.jsx)("div",{className:"h-2 rounded-full ".concat(((null===(v=I.system)||void 0===v?void 0:v.memory_usage)||0)>1e3?"bg-red-500":"bg-blue-500"),style:{width:"".concat(Math.min(((null===(j=I.system)||void 0===j?void 0:j.memory_usage)||0)/20,100),"%")}})})]}),(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{children:"Requests/min"}),(0,s.jsx)("span",{children:(null===(f=I.performance)||void 0===f?void 0:f.requests_per_minute)||0})]})}),(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{children:"Tiempo de respuesta"}),(0,s.jsxs)("span",{children:[(null===(w=I.performance)||void 0===w?void 0:w.avg_processing_time)||0,"s"]})]})})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Estado de Servicios"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:"WhatsApp"}),(0,s.jsx)("div",{className:"flex items-center",children:(null===(C=I.services)||void 0===C?void 0:C.whatsapp)==="connected"?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.Z,{className:"h-5 w-5 text-green-500 mr-2"}),(0,s.jsx)("span",{className:"text-sm text-green-600",children:"Conectado"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p.Z,{className:"h-5 w-5 text-red-500 mr-2"}),(0,s.jsx)("span",{className:"text-sm text-red-600",children:"Desconectado"})]})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:"LM Studio"}),(0,s.jsx)("div",{className:"flex items-center",children:(null===(k=I.services)||void 0===k?void 0:k.lm_studio)==="running"?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.Z,{className:"h-5 w-5 text-green-500 mr-2"}),(0,s.jsx)("span",{className:"text-sm text-green-600",children:"Ejecut\xe1ndose"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p.Z,{className:"h-5 w-5 text-red-500 mr-2"}),(0,s.jsx)("span",{className:"text-sm text-red-600",children:"Detenido"})]})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:"Base de Datos"}),(0,s.jsx)("div",{className:"flex items-center",children:(null===(_=I.services)||void 0===_?void 0:_.database)==="active"?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.Z,{className:"h-5 w-5 text-green-500 mr-2"}),(0,s.jsx)("span",{className:"text-sm text-green-600",children:"Activa"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p.Z,{className:"h-5 w-5 text-red-500 mr-2"}),(0,s.jsx)("span",{className:"text-sm text-red-600",children:"Inactiva"})]})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:"API Server"}),(0,s.jsx)("div",{className:"flex items-center",children:(null===(E=I.services)||void 0===E?void 0:E.api_server)==="active"?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.Z,{className:"h-5 w-5 text-green-500 mr-2"}),(0,s.jsx)("span",{className:"text-sm text-green-600",children:"Activo"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p.Z,{className:"h-5 w-5 text-red-500 mr-2"}),(0,s.jsx)("span",{className:"text-sm text-red-600",children:"Inactivo"})]})})]})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Eventos Recientes"}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(W?"bg-green-500 animate-pulse":"bg-gray-400")}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:W?"Tiempo Real":"Manual"})]}),(0,s.jsxs)("button",{onClick:()=>z(!W),className:"px-3 py-1 text-xs rounded-full transition-colors ".concat(W?"bg-green-100 text-green-700 hover:bg-green-200":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:[W?"Desactivar":"Activar"," Tiempo Real"]}),(0,s.jsxs)("span",{className:"text-xs text-gray-400",children:["\xdaltima actualizaci\xf3n: ",V.toLocaleTimeString()]})]})]}),(0,s.jsx)("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:O.length>0?O.map((e,a)=>(0,s.jsxs)("div",{className:"flex items-start space-x-3 p-3 rounded-lg border-l-4 transition-colors ".concat((e=>{switch(e){case"message":return"bg-blue-50 border-l-blue-300";case"system":return"bg-green-50 border-l-green-300";case"connection":return"bg-emerald-50 border-l-emerald-300";default:return"bg-gray-50 border-l-gray-300"}})(e.type)),children:[(0,s.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:(e=>{switch(e){case"message":return(0,s.jsx)(R.Z,{className:"h-4 w-4 text-blue-500"});case"system":return(0,s.jsx)(N.Z,{className:"h-4 w-4 text-green-500"});case"connection":return(0,s.jsx)(u.Z,{className:"h-4 w-4 text-emerald-500"});default:return(0,s.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})}})(e.type)}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.message}),(0,s.jsx)("span",{className:"text-xs text-gray-400 uppercase tracking-wider",children:e.type})]}),e.details&&(0,s.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:e.details}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:new Date(e.timestamp).toLocaleString("es-ES",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})})]})]},a)):(0,s.jsx)("div",{className:"text-center text-gray-500 py-4",children:"No hay eventos recientes"})})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"M\xe9tricas de Conversaciones"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:(null===(S=I.conversations)||void 0===S?void 0:S.active_chats)||0}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:"Chats Activos"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-green-600",children:(null===(A=I.messages)||void 0===A?void 0:A.automated_responses)||0}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:"Respuestas Autom\xe1ticas"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("div",{className:"text-2xl font-bold text-purple-600",children:[(null===(Z=I.messages)||void 0===Z?void 0:Z.avg_response_time)||0,"s"]}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:"Tiempo Promedio"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:(null===(P=I.conversations)||void 0===P?void 0:P.avg_conversation_length)||0}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:"Mensajes por Chat"})]})]})]})]})}V.kL.register(V.uw,V.f$,V.od,V.jn,V.ZL,V.Dx,V.u,V.De);let H={ai_third_layer:{enabled:!0,trigger_mode:"conversations",min_conversations:10,min_messages_per_conversation:10,time_interval_hours:720},media:{whisper_enabled:!0,whisper_model:"whisper-1",vision_enabled:!0,vision_model:"gpt-4-vision-preview"},whatsapp:{mode:"playwright"}};function Q(){let[e,a]=(0,r.useState)(H),[t,n]=(0,r.useState)(!0),[i,o]=(0,r.useState)(!1),[c,d]=(0,r.useState)(null);(0,r.useEffect)(()=>{m()},[]);let m=async()=>{try{let e=await l.getAdvancedSettings();a(e)}catch(e){console.error("Failed to load settings:",e)}finally{n(!1)}},h=async()=>{o(!0),d(null);try{await l.saveAdvancedSettings(e),d({type:"success",text:"âœ“ Configuraci\xf3n guardada correctamente"})}catch(e){d({type:"error",text:"âœ— Error al guardar configuraci\xf3n"})}finally{o(!1)}},x=(e,t)=>{a(a=>({...a,ai_third_layer:{...a.ai_third_layer,[e]:t}}))},u=(e,t)=>{a(a=>({...a,media:{...a.media,[e]:t}}))},g=(e,t)=>{a(a=>({...a,whatsapp:{...a.whatsapp,[e]:t}}))};return t?(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Configuraci\xf3n Avanzada"}),(0,s.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Gestiona las funcionalidades de IA, multimedia y conectividad"})]}),(0,s.jsx)("button",{onClick:h,disabled:i,className:"px-6 py-2.5 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-medium rounded-lg hover:from-blue-700 hover:to-indigo-700 transition-all duration-200 disabled:opacity-50 shadow-lg hover:shadow-xl",children:i?"Guardando...":"\uD83D\uDCBE Guardar Cambios"})]}),c&&(0,s.jsx)("div",{className:"p-4 rounded-lg ".concat("success"===c.type?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"),children:c.text}),(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:[(0,s.jsxs)("div",{className:"px-6 py-4 bg-gradient-to-r from-purple-500 to-indigo-600",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:"\uD83E\uDDE0 IA Tercera Capa (Global Learner)"}),(0,s.jsx)("p",{className:"text-purple-100 text-sm",children:"Sistema de aprendizaje autom\xe1tico que mejora las estrategias"})]}),(0,s.jsxs)("div",{className:"p-6 space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:"Habilitar Tercera Capa"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"An\xe1lisis autom\xe1tico de conversaciones para mejorar estrategias"})]}),(0,s.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",checked:e.ai_third_layer.enabled,onChange:e=>x("enabled",e.target.checked),className:"sr-only peer"}),(0,s.jsx)("div",{className:"w-14 h-7 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all dark:border-gray-600 peer-checked:bg-gradient-to-r peer-checked:from-blue-500 peer-checked:to-indigo-600"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Modo de Activaci\xf3n"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("button",{onClick:()=>x("trigger_mode","conversations"),className:"p-4 rounded-lg border-2 transition-all ".concat("conversations"===e.ai_third_layer.trigger_mode?"border-blue-500 bg-blue-50 dark:bg-blue-900/30":"border-gray-200 dark:border-gray-600 hover:border-gray-300"),children:[(0,s.jsx)("div",{className:"text-2xl mb-2",children:"\uD83D\uDCAC"}),(0,s.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:"Por Conversaciones"}),(0,s.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Tras N conversaciones largas"})]}),(0,s.jsxs)("button",{onClick:()=>x("trigger_mode","time"),className:"p-4 rounded-lg border-2 transition-all ".concat("time"===e.ai_third_layer.trigger_mode?"border-blue-500 bg-blue-50 dark:bg-blue-900/30":"border-gray-200 dark:border-gray-600 hover:border-gray-300"),children:[(0,s.jsx)("div",{className:"text-2xl mb-2",children:"â°"}),(0,s.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:"Por Tiempo"}),(0,s.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Cada N horas/d\xedas"})]})]})]}),"conversations"===e.ai_third_layer.trigger_mode&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"M\xednimo de Conversaciones"}),(0,s.jsx)("span",{className:"text-sm font-bold text-blue-600",children:e.ai_third_layer.min_conversations})]}),(0,s.jsx)("input",{type:"range",min:"5",max:"100",value:e.ai_third_layer.min_conversations,onChange:e=>x("min_conversations",parseInt(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700 accent-blue-600"}),(0,s.jsxs)("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[(0,s.jsx)("span",{children:"5 (frecuente)"}),(0,s.jsx)("span",{children:"100 (empresa grande)"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"M\xednimo Mensajes por Conversaci\xf3n"}),(0,s.jsx)("span",{className:"text-sm font-bold text-blue-600",children:e.ai_third_layer.min_messages_per_conversation})]}),(0,s.jsx)("input",{type:"range",min:"3",max:"50",value:e.ai_third_layer.min_messages_per_conversation,onChange:e=>x("min_messages_per_conversation",parseInt(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700 accent-blue-600"})]})]}),"time"===e.ai_third_layer.trigger_mode&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Intervalo de Tiempo"}),(0,s.jsxs)("span",{className:"text-sm font-bold text-blue-600",children:[Math.round(e.ai_third_layer.time_interval_hours/24)," d\xedas"]})]}),(0,s.jsx)("input",{type:"range",min:"24",max:"2160",step:"24",value:e.ai_third_layer.time_interval_hours,onChange:e=>x("time_interval_hours",parseInt(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700 accent-blue-600"}),(0,s.jsxs)("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[(0,s.jsx)("span",{children:"1 d\xeda"}),(0,s.jsx)("span",{children:"90 d\xedas"})]})]})]})]}),(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:[(0,s.jsxs)("div",{className:"px-6 py-4 bg-gradient-to-r from-green-500 to-teal-600",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:"\uD83C\uDFA4 Procesamiento Multimedia"}),(0,s.jsx)("p",{className:"text-green-100 text-sm",children:"Transcripci\xf3n de audio y an\xe1lisis de im\xe1genes"})]}),(0,s.jsxs)("div",{className:"p-6 grid md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-orange-400 to-red-500 flex items-center justify-center text-white text-xl",children:"\uD83C\uDF99ï¸"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:"Whisper (Audio)"}),(0,s.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Transcripci\xf3n autom\xe1tica"})]})]}),(0,s.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",checked:e.media.whisper_enabled,onChange:e=>u("whisper_enabled",e.target.checked),className:"sr-only peer"}),(0,s.jsx)("div",{className:"w-11 h-6 bg-gray-200 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-500"})]})]}),(0,s.jsxs)("select",{value:e.media.whisper_model,onChange:e=>u("whisper_model",e.target.value),disabled:!e.media.whisper_enabled,className:"w-full p-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white disabled:opacity-50",children:[(0,s.jsx)("option",{value:"whisper-1",children:"whisper-1 (OpenAI)"}),(0,s.jsx)("option",{value:"whisper-local",children:"whisper-local (LM Studio)"})]})]}),(0,s.jsxs)("div",{className:"p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white text-xl",children:"\uD83D\uDC41ï¸"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:"Vision (Im\xe1genes)"}),(0,s.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"An\xe1lisis visual"})]})]}),(0,s.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",checked:e.media.vision_enabled,onChange:e=>u("vision_enabled",e.target.checked),className:"sr-only peer"}),(0,s.jsx)("div",{className:"w-11 h-6 bg-gray-200 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-500"})]})]}),(0,s.jsxs)("select",{value:e.media.vision_model,onChange:e=>u("vision_model",e.target.value),disabled:!e.media.vision_enabled,className:"w-full p-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white disabled:opacity-50",children:[(0,s.jsx)("option",{value:"gpt-4-vision-preview",children:"GPT-4 Vision (OpenAI)"}),(0,s.jsx)("option",{value:"gemini-pro-vision",children:"Gemini Pro Vision"}),(0,s.jsx)("option",{value:"claude-3-opus",children:"Claude 3 Opus"})]})]})]})]}),(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:[(0,s.jsxs)("div",{className:"px-6 py-4 bg-gradient-to-r from-green-600 to-emerald-600",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:"\uD83D\uDCF1 Modo de WhatsApp"}),(0,s.jsx)("p",{className:"text-green-100 text-sm",children:"Selecciona c\xf3mo conectar con WhatsApp"})]}),(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,s.jsxs)("button",{onClick:()=>g("mode","playwright"),className:"p-6 rounded-xl border-2 transition-all text-left ".concat("playwright"===e.whatsapp.mode?"border-green-500 bg-green-50 dark:bg-green-900/30 shadow-lg":"border-gray-200 dark:border-gray-600 hover:border-gray-300"),children:[(0,s.jsx)("div",{className:"text-3xl mb-3",children:"\uD83C\uDFAD"}),(0,s.jsx)("div",{className:"font-semibold text-gray-900 dark:text-white text-lg",children:"Playwright (Automator)"}),(0,s.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:"Automatiza WhatsApp Web usando un navegador. No requiere cuenta empresarial."}),(0,s.jsxs)("div",{className:"mt-3 flex items-center gap-2 text-xs",children:[(0,s.jsx)("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300 rounded",children:"Gratis"}),(0,s.jsx)("span",{className:"px-2 py-1 bg-yellow-100 dark:bg-yellow-900/50 text-yellow-700 dark:text-yellow-300 rounded",children:"Requiere sesi\xf3n"})]})]}),(0,s.jsxs)("button",{onClick:()=>g("mode","business_api"),className:"p-6 rounded-xl border-2 transition-all text-left ".concat("business_api"===e.whatsapp.mode?"border-green-500 bg-green-50 dark:bg-green-900/30 shadow-lg":"border-gray-200 dark:border-gray-600 hover:border-gray-300"),children:[(0,s.jsx)("div",{className:"text-3xl mb-3",children:"\uD83C\uDFE2"}),(0,s.jsx)("div",{className:"font-semibold text-gray-900 dark:text-white text-lg",children:"Business API (Oficial)"}),(0,s.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:"API oficial de Meta para empresas. M\xe1s estable y con m\xe1s funciones."}),(0,s.jsxs)("div",{className:"mt-3 flex items-center gap-2 text-xs",children:[(0,s.jsx)("span",{className:"px-2 py-1 bg-purple-100 dark:bg-purple-900/50 text-purple-700 dark:text-purple-300 rounded",children:"Empresarial"}),(0,s.jsx)("span",{className:"px-2 py-1 bg-green-100 dark:bg-green-900/50 text-green-700 dark:text-green-300 rounded",children:"Webhooks"})]})]})]}),"business_api"===e.whatsapp.mode&&(0,s.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Token de API"}),(0,s.jsx)("input",{type:"password",value:e.whatsapp.business_api_token||"",onChange:e=>g("business_api_token",e.target.value),placeholder:"EAAxxxxxxxxx...",className:"w-full p-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Phone Number ID"}),(0,s.jsx)("input",{type:"text",value:e.whatsapp.business_phone_id||"",onChange:e=>g("business_phone_id",e.target.value),placeholder:"1234567890",className:"w-full p-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]})]})]})]})]})}function $(){let[e,a]=(0,r.useState)("main"),[t,n]=(0,r.useState)(null),[i,o]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{let e=async()=>{try{let e=await l.getSystemStatus();n(e)}catch(e){console.error("Error al obtener estado del sistema:",e),n({status:"error",message:"Backend no disponible"})}finally{o(!1)}};e();let a=setInterval(e,3e4);return()=>clearInterval(a)},[]),i)?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Conectando con el sistema..."})]})}):(0,s.jsxs)("div",{className:"flex min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:[(0,s.jsx)(y,{currentPage:e,onPageChange:a,systemStatus:t}),(0,s.jsx)("main",{className:"flex-1 p-6 overflow-auto",children:(()=>{switch(e){case"main":default:return(0,s.jsx)(E,{systemStatus:t});case"config":return(0,s.jsx)(M,{});case"contacts":return(0,s.jsx)(z,{});case"stats":return(0,s.jsx)(X,{});case"advanced":return(0,s.jsx)(Q,{})}})()})]})}}},function(e){e.O(0,[674,64,698,971,117,744],function(){return e(e.s=7728)}),_N_E=e.O()}]);