<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="common.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.1.6/purify.min.js" integrity="sha512-jB0TkTBeQC9ZSkBqDhdmfTv1qdfbWpGE72yJ/01Srq6hEzZIz2xkz1e57p9ai7IeHMwEG7HpzG6NdptChif5Pg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="/ui/auth.js"></script>
    <script src="/ui/api.js"></script>
    <script src="/ui/sanitize.js"></script>

    <title> Configurador de Negocio - AI Chatbot</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <link rel="stylesheet" href="/ui/business_config.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-robot"></i> Configurador de Negocio</h1>
            <p>Personaliza tu asistente virtual para que se adapte perfectamente a tu negocio</p>
        </div>

        <div class="tabs">
            <button class="tab active" data-tab="basic" id="tabBasic">
                <i class="fas fa-building"></i> Informaci贸n B谩sica
            </button>
            <button class="tab" data-tab="behavior" id="tabBehavior">
                <i class="fas fa-brain"></i> Comportamiento IA
            </button>
            <button class="tab" data-tab="flow" id="tabFlow">
                <i class="fas fa-comments"></i> Flujo de Conversaci贸n
            </button>
            <button class="tab" data-tab="preview" id="tabPreview">
                <i class="fas fa-eye"></i> Vista Previa
            </button>
        </div>

        <div class="content">
            <!-- Alertas -->
            <div id="alerts"></div>

            <!-- Loading -->
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Cargando configuraci贸n...</p>
            </div>

            <!-- Informaci贸n B谩sica -->
            <div id="basic" class="tab-content active">
                <div class="form-section">
                    <h3><i class="fas fa-store"></i> Informaci贸n del Negocio</h3>
                    
                    <div class="form-group">
                        <label for="business_name">Nombre del Negocio *</label>
                        <input type="text" id="business_name" placeholder="Ej: Florer铆a Bella Rosa, Panader铆a El Buen Pan">
                    </div>

                    <div class="form-group">
                        <label for="business_description">Descripci贸n del Negocio *</label>
                        <textarea id="business_description" placeholder="Describe tu negocio: qu茅 servicios ofreces, cu谩l es tu especialidad, qu茅 te diferencia de la competencia..."></textarea>
                    </div>

                    <div class="form-group">
                        <label for="business_greeting">Saludo de Bienvenida *</label>
                        <textarea id="business_greeting" placeholder="隆Hola! Bienvenido/a a [NOMBRE_NEGOCIO]. 驴En qu茅 puedo ayudarte hoy?"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="primary_goal">Objetivo Principal con Clientes *</label>
                        <textarea id="primary_goal" placeholder="Ej: Generar ventas, agendar citas, brindar soporte, recopilar informaci贸n..."></textarea>
                    </div>
                </div>

                <div class="form-section">
                    <h3><i class="fas fa-list"></i> Servicios y Contacto</h3>
                    
                    <div class="form-group">
                        <label for="addServicesBtn">Servicios/Productos Principales</label>
                        <div class="list-input">
                            <div id="services_list" class="list-items"></div>
                            <button type="button" class="add-item-btn" data-list="services" id="addServicesBtn">
                                <i class="fas fa-plus"></i> Agregar Servicio
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="business_hours">Horarios de Atenci贸n</label>
                        <input type="text" id="business_hours" placeholder="Ej: Lunes a Viernes 9:00 AM - 6:00 PM">
                    </div>

                    <div class="form-group">
                        <label for="contact_info">Informaci贸n de Contacto</label>
                        <input type="text" id="contact_info" placeholder="Email, tel茅fono, direcci贸n...">
                    </div>
                </div>
            </div>

            <!-- Comportamiento IA -->
            <div id="behavior" class="tab-content">
                <div class="form-section">
                    <h3><i class="fas fa-robot"></i> Personalidad de la IA</h3>
                    
                    <div class="form-group">
                        <label for="addPersonalityBtn">Caracter铆sticas de Personalidad</label>
                        <div class="list-input">
                            <div id="personality_list" class="list-items"></div>
                            <button type="button" class="add-item-btn" data-list="personality" id="addPersonalityBtn">
                                <i class="fas fa-plus"></i> Agregar Caracter铆stica
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="addForbiddenBtn">Temas Prohibidos</label>
                        <div class="list-input">
                            <div id="forbidden_list" class="list-items"></div>
                            <button type="button" class="add-item-btn" data-list="forbidden" id="addForbiddenBtn">
                                <i class="fas fa-plus"></i> Agregar Tema Prohibido
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="tone">Tono de Comunicaci贸n</label>
                        <select id="tone">
                            <option value="formal">Formal</option>
                            <option value="profesional_amigable">Profesional pero Amigable</option>
                            <option value="casual_profesional">Casual Profesional</option>
                            <option value="casual">Casual</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Flujo de Conversaci贸n -->
            <div id="flow" class="tab-content">
                <div class="form-section">
                    <h3><i class="fas fa-exchange-alt"></i> Objetivos y Conversi贸n</h3>
                    
                    <div class="form-group">
                        <label for="addKeywordsBtn">Palabras Clave de Conversi贸n</label>
                        <div class="list-input">
                            <div id="keywords_list" class="list-items"></div>
                            <button type="button" class="add-item-btn" data-list="keywords" id="addKeywordsBtn">
                                <i class="fas fa-plus"></i> Agregar Palabra Clave
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="addQuestionsBtn">Preguntas de Calificaci贸n</label>
                        <div class="list-input">
                            <div id="questions_list" class="list-items"></div>
                            <button type="button" class="add-item-btn" data-list="questions" id="addQuestionsBtn">
                                <i class="fas fa-plus"></i> Agregar Pregunta
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="closing_message">Mensaje de Cierre</label>
                        <textarea id="closing_message" placeholder="Gracias por contactarnos. 隆Que tengas un excelente d铆a!"></textarea>
                    </div>
                </div>
            </div>

            <!-- Vista Previa -->
            <div id="preview" class="tab-content">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="config_completeness">0%</div>
                        <div class="stat-label">Configuraci贸n Completa</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="prompt_length">0</div>
                        <div class="stat-label">Caracteres del Prompt</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="services_count">0</div>
                        <div class="stat-label">Servicios Configurados</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="personality_count">0</div>
                        <div class="stat-label">Caracter铆sticas de Personalidad</div>
                    </div>
                </div>

                <div class="preview-section">
                    <h3><i class="fas fa-file-alt"></i> Prompt Generado</h3>
                    <div class="preview-content" id="generated_prompt">
                        Carga la configuraci贸n para ver el prompt generado...
                    </div>
                </div>

                <button class="btn btn-primary" id="previewRefreshBtn">
                    <i class="fas fa-sync"></i> Actualizar Vista Previa
                </button>
            </div>
        </div>

        <div class="actions">
            <button class="btn btn-success" id="saveConfigBtn">
                <i class="fas fa-save"></i> Guardar Configuraci贸n
            </button>
            
            <button class="btn btn-primary" id="previewBtn">
                <i class="fas fa-eye"></i> Vista Previa
            </button>
            
            <button class="btn btn-warning" id="exportBtn">
                <i class="fas fa-download"></i> Exportar
            </button>
            
            <button class="btn btn-secondary" id="importBtn">
                <i class="fas fa-upload"></i> Importar
            </button>
            
            <button class="btn btn-danger" id="resetBtn">
                <i class="fas fa-undo"></i> Reiniciar
            </button>
        </div>
    </div>

    <!-- Input file oculto para importar -->
    <input type="file" id="import_file" accept=".json" class="hidden-file-input">

    <!-- requireAuth('/ui/login.html') -->
    <!-- window.Api apiJson apiRequest -->
    <script src="/ui/business_config.js" defer></script>
</body>
</html>
