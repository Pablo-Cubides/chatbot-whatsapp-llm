<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="common.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.1.6/purify.min.js" integrity="sha512-jB0TkTBeQC9ZSkBqDhdmfTv1qdfbWpGE72yJ/01Srq6hEzZIz2xkz1e57p9ai7IeHMwEG7HpzG6NdptChif5Pg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="/ui/auth.js"></script>
    <script src="/ui/api.js"></script>
    <script src="/ui/sanitize.js"></script>
    <script src="/ui/toast.js"></script>

    <title>ü§ñ WhatsApp AI Chatbot - Panel de Control</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <link rel="stylesheet" href="index.css">
</head>

<body>
    <div class="container">
        <div class="header">
            <div class="user-header">
                <div class="user-info">
                    <i class="fas fa-user-circle"></i>
                    <span id="usernameDisplay">Usuario</span>
                </div>
                <button class="logout-btn" id="logoutBtn" type="button">
                    <i class="fas fa-sign-out-alt"></i> Cerrar Sesi√≥n
                </button>
            </div>
            <h1><i class="fas fa-robot"></i> WhatsApp AI Chatbot</h1>
            <p>Panel de Control Unificado - Gestiona tu asistente virtual empresarial con m√∫ltiples proveedores de IA
            </p>
        </div>

        <div class="dashboard">
            <!-- Setup Checklist -->
            <div class="setup-checklist" id="setupChecklist">
                <h3><i class="fas fa-tasks"></i> Progreso de Configuraci√≥n</h3>
                <div class="checklist-items">
                    <div class="checklist-item not-started" id="checkBusiness">
                        <div class="checklist-icon"><i class="fas fa-store"></i></div>
                        <div>
                            <strong>Configurar Negocio</strong>
                            <div class="checklist-meta">Nombre y descripci√≥n</div>
                        </div>
                    </div>
                    <div class="checklist-item not-started" id="checkWhatsApp">
                        <div class="checklist-icon"><i class="fab fa-whatsapp"></i></div>
                        <div>
                            <strong>WhatsApp</strong>
                            <div class="checklist-meta">Modo de conexi√≥n</div>
                        </div>
                    </div>
                    <div class="checklist-item not-started" id="checkAI">
                        <div class="checklist-icon"><i class="fas fa-brain"></i></div>
                        <div>
                            <strong>APIs de IA</strong>
                            <div class="checklist-meta">Proveedores configurados</div>
                        </div>
                    </div>
                    <div class="checklist-item not-started" id="checkBot">
                        <div class="checklist-icon"><i class="fas fa-play"></i></div>
                        <div>
                            <strong>Bot Activo</strong>
                            <div class="checklist-meta">Listo para mensajes</div>
                        </div>
                    </div>
                </div>
                <p class="setup-help-text">
                    ¬øPrimera vez? <a href="setup.html" class="setup-link">Ir al asistente de configuraci√≥n ‚Üí</a>
                </p>
            </div>

            <div class="feature-highlight">
                <h3><i class="fas fa-magic"></i> ¬°Configuraci√≥n 100% Personalizable!</h3>
                <p>Ahora puedes personalizar completamente tu chatbot sin tipos de negocio predefinidos. Define tu
                    propia personalidad, objetivos y flujo de conversaci√≥n.</p>
            </div>

            <!-- Estado del Sistema -->
            <div class="status-section">
                <h2 class="section-title-center">
                    <i class="fas fa-chart-line"></i> Estado del Sistema
                </h2>
                <div class="status-grid">
                    <div class="status-item">
                        <div class="status-icon status-online">
                            <i class="fas fa-server"></i>
                        </div>
                        <h4>API Server</h4>
                        <p>En l√≠nea</p>
                    </div>
                    <div class="status-item">
                        <div class="status-icon status-warning">
                            <i class="fas fa-whatsapp"></i>
                        </div>
                        <h4>WhatsApp Bot</h4>
                        <p>Configurar</p>
                    </div>
                    <div class="status-item">
                        <div class="status-icon status-online">
                            <i class="fas fa-brain"></i>
                        </div>
                        <h4>Multi-IA</h4>
                        <p>6 APIs Activas</p>
                    </div>
                    <div class="status-item">
                        <div class="status-icon status-online">
                            <i class="fas fa-database"></i>
                        </div>
                        <h4>Base de Datos</h4>
                        <p>Conectada</p>
                    </div>
                </div>
            </div>

            <!-- Tarjetas Principales -->
            <div class="cards-grid">
                <!-- Configuraci√≥n de Negocio -->
                <div class="card config-card">
                    <div class="card-icon">
                        <i class="fas fa-cogs"></i>
                    </div>
                    <div class="card-title">Configuraci√≥n de Negocio</div>
                    <div class="card-description">
                        Personaliza completamente tu chatbot: describe tu negocio, define la personalidad de la IA y
                        configura el flujo de conversaci√≥n.
                    </div>
                    <a href="business_config.html" class="card-button">
                        <i class="fas fa-edit"></i> Configurar Ahora
                    </a>
                </div>

                <!-- Panel de Chat -->
                <div class="card primary-card">
                    <div class="card-icon">
                        <i class="fas fa-comments"></i>
                    </div>
                    <div class="card-title">Chat de Prueba</div>
                    <div class="card-description">
                        Prueba tu chatbot directamente desde el panel. Verifica respuestas y ajusta la configuraci√≥n en
                        tiempo real.
                    </div>
                    <a href="chat.html" class="card-button">
                        <i class="fas fa-play"></i> Probar Chat
                    </a>
                </div>

                <!-- Monitoreo -->
                <div class="card monitor-card">
                    <div class="card-icon">
                        <i class="fas fa-chart-bar"></i>
                    </div>
                    <div class="card-title">Monitoreo & Analytics</div>
                    <div class="card-description">
                        Visualiza m√©tricas de conversaciones, uso de APIs, y rendimiento del chatbot en tiempo real.
                    </div>
                    <a href="analytics.html" class="card-button">
                        <i class="fas fa-chart-line"></i> Ver Analytics
                    </a>
                </div>

                <!-- Realtime Dashboard -->
                <div class="card realtime-card">
                    <div class="card-icon">
                        <i class="fas fa-tachometer-alt"></i>
                    </div>
                    <div class="card-title">Realtime Dashboard</div>
                    <div class="card-description">
                        Supervisa en vivo conexiones, m√©tricas operativas y estado del sistema en una sola vista.
                    </div>
                    <a href="realtime_dashboard.html" class="card-button card-button-light">
                        <i class="fas fa-chart-area"></i> Abrir Realtime
                    </a>
                </div>

                <!-- APIs & Modelos -->
                <div class="card api-card">
                    <div class="card-icon">
                        <i class="fas fa-microchip"></i>
                    </div>
                    <div class="card-title">Gesti√≥n de APIs</div>
                    <div class="card-description">
                        Administra m√∫ltiples proveedores de IA: Gemini, OpenAI, Grok, Claude, Ollama y LM Studio con
                        fallback inteligente.
                    </div>
                    <button class="card-button" id="apiManagementBtn" type="button">
                        <i class="fas fa-network-wired"></i> Gestionar APIs
                    </button>
                </div>

                <!-- Sistema de Alertas -->
                <div class="card alerts-card">
                    <div class="card-icon">
                        <i class="fas fa-bell"></i>
                    </div>
                    <div class="card-title">Sistema de Alertas</div>
                    <div class="card-description">
                        Monitorea alertas autom√°ticas, gestiona prioridades y asigna tareas a tu equipo en tiempo real.
                    </div>
                    <a href="alerts.html" class="card-button card-button-light">
                        <i class="fas fa-exclamation-triangle"></i> Ver Alertas
                    </a>
                </div>

                <!-- Campa√±as y Cola -->
                <div class="card campaigns-card">
                    <div class="card-icon">
                        <i class="fas fa-paper-plane"></i>
                    </div>
                    <div class="card-title">Campa√±as Masivas</div>
                    <div class="card-description">
                        Crea y gestiona campa√±as de mensajes masivos, programa env√≠os y monitorea el estado de la cola.
                    </div>
                    <button class="card-button card-button-light" id="campaignsBtn" type="button">
                        <i class="fas fa-bullhorn"></i> Gestionar Campa√±as
                    </button>
                </div>

                <!-- Scheduler y WhatsApp Provider -->
                <div class="card scheduler-card">
                    <div class="card-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="card-title">Mensajes Programados</div>
                    <div class="card-description">
                        Programa mensajes para env√≠o futuro y configura el provider de WhatsApp (Web/Cloud API).
                    </div>
                    <button class="card-button card-button-light" id="schedulerBtn" type="button">
                        <i class="fas fa-calendar-alt"></i> Ver Programados
                    </button>
                </div>

                <!-- Estado WhatsApp Provider -->
                <div class="card provider-card">
                    <div class="card-icon">
                        <i class="fab fa-whatsapp"></i>
                    </div>
                    <div class="card-title">WhatsApp Provider</div>
                    <div class="card-description">
                        Configura y monitorea el proveedor de WhatsApp: Web (Playwright) o Cloud API oficial.
                    </div>
                    <button class="card-button card-button-light" id="providerBtn" type="button">
                        <i class="fas fa-cog"></i> Configurar Provider
                    </button>
                </div>

                <!-- Calendario y Citas -->
                <div class="card calendar-card">
                    <div class="card-icon">
                        <i class="fas fa-calendar-alt"></i>
                    </div>
                    <div class="card-title">Calendario y Citas</div>
                    <div class="card-description">
                        Conecta Google Calendar o Outlook para agendar citas autom√°ticamente desde WhatsApp.
                    </div>
                    <a href="calendar_config.html" class="card-button card-button-light">
                        <i class="fas fa-calendar-check"></i> Configurar Calendario
                    </a>
                </div>
            </div>

            <!-- Acciones R√°pidas -->
            <div class="quick-actions">
                <a href="business_config.html" class="action-btn action-primary">
                    <i class="fas fa-magic"></i>
                    Configurar Mi Negocio
                </a>

                <button class="action-btn action-success" id="startBotBtn" type="button">
                    <i class="fas fa-whatsapp"></i>
                    Iniciar WhatsApp Bot
                </button>

                <button class="action-btn action-warning" id="testApisBtn" type="button">
                    <i class="fas fa-test-tube"></i>
                    Probar APIs
                </button>

                <button class="action-btn action-danger" id="viewLogsBtn" type="button">
                    <i class="fas fa-file-alt"></i>
                    Ver Logs
                </button>
            </div>
        </div>

        <div class="footer">
            <p>
                <i class="fas fa-copyright"></i> <span id="copyrightYear"></span> WhatsApp AI Chatbot -
                Configuraci√≥n Enterprise Universal con M√∫ltiples Proveedores de IA
            </p>
            <p class="footer-subtitle">
                APIs Integradas: Gemini, OpenAI GPT-4, Grok xAI, Claude, Ollama, LM Studio
            </p>
        </div>
    </div>

    <!-- Compat contract marker: document.addEventListener('DOMContentLoaded', async function () -->
    <!-- Compat contract marker: if (!window.Auth || !window.Auth.requireAuth('/ui/login.html')) -->
    <!-- Compat contract marker: if (window.Auth && typeof window.Auth.logout === 'function') -->
    <!-- Compat contract marker: window.Auth.logout('/ui/login.html'); -->
    <!-- Compat contract marker: sessionStorage.removeItem('token') -->
    <!-- Compat contract marker: window.location.href = '/ui/login.html'; -->
    <!-- Compat contract marker: apiJson( -->
    <script src="/ui/index.js"></script>
</body>

</html>